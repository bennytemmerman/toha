<!doctype html><html lang=en><head><title>SIEM data onboarding</title><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.357dd1de946e0748ed1ed88009a6203f270bccbdabe5793ab4aab15964be163a.css integrity="sha256-NX3R3pRuB0jtHtiACaYgPycLzL2r5Xk6tKqxWWS+Fjo="><link rel=icon type=image/png href=/images/site/favicon_hu_600b31f4ce216cf3.png><meta property="og:title" content="SIEMForge"><meta property="og:type" content="website"><meta property="og:description" content="Portfolio and personal blog of Benny Temmerman, SIEMForge"><meta property="og:image" content="/images/site/background.jpg"><meta property="og:url" content="https://siemforge.xyz"><meta name=description content="Best practices and a deepdive into Splunk vs Microsoft Sentinel"><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "c845fbe0ec8f4fe1b3d3db62cc771051"}'></script><script integrity="sha256-DO4ugzEwhTW1Id1UIWn0gUJWaebCYOypeTit6LW4QB4=">let theme=localStorage.getItem("theme-scheme")||localStorage.getItem("darkmode:color-scheme")||"light";theme==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?theme="dark":theme="light"),document.documentElement.setAttribute("data-theme",theme)</script></head><body class="type-posts kind-page" data-bs-spy=scroll data-bs-target=#TableOfContents data-bs-offset=80><div class="container-fluid bg-secondary wrapper"><nav class="navbar navbar-expand-xl top-navbar shadow" id=top-navbar><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<i data-feather=sidebar></i>
</button>
<a class=navbar-brand href=/><img src=/images/site/main-logo_hu_600b31f4ce216cf3.png id=logo alt=Logo>
SIEMForge</a>
<button class="navbar-toggler navbar-light" id=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#top-nav-items aria-label=menu>
<i data-feather=menu></i></button><div class="collapse navbar-collapse dynamic-navbar" id=top-nav-items><ul class="nav navbar-nav ms-auto"><li class=nav-item><a class=nav-link href=/#home>Home</a></li><li class=nav-item><a class=nav-link href=/#about>About</a></li><li class=nav-item><a class=nav-link href=/#skills>Skills</a></li><li class=nav-item><a class=nav-link href=/#experiences>Experiences</a></li><li class=nav-item><a class=nav-link href=/#projects>Projects</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>More</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=/#featured-posts>Featured Posts</a>
<a class=dropdown-item href=/#accomplishments>Accomplishments</a></div></li><div id=top-navbar-divider></div><li class=nav-item><a class=nav-link id=blog-link href=/posts>Posts</a></li><li class=nav-item><a class=nav-link id=note-link href=/notes>Notes</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=theme-icon src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=theme-icon src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/main-logo_hu_600b31f4ce216cf3.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/inverted-logo_hu_600b31f4ce216cf3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><i data-feather=plus-circle></i><a class=list-link href=/posts/linux/> Linux</a><ul><li><a class=list-link href=/posts/linux/logrotate/logrotatepost/ title=Logrotate>Logrotate</a></li><li><a class=list-link href=/posts/linux/lvm/lvmpost/ title=LVM>LVM</a></li><li><a class=list-link href=/posts/linux/tcpdump/tcpdumppost/ title=tcpdump>tcpdump</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/automation/> Automation</a><ul><li><a class=list-link href=/posts/automation/n8n/firstautomationworkflow/ title="My first automation workflow">My first automation workflow</a></li></ul></li><li><i data-feather=minus-circle></i><a class="active list-link" href=/posts/siem/> SIEM</a><ul class=active><li><a class="active list-link" href=/posts/siem/data-onboarding/dataonboardingpost/ title="SIEM data onboarding">SIEM data onboarding</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/images/posts/siem.jpg)></div><div class=page-content><div class="author-profile ms-auto align-self-lg-center"><img class=rounded-circle src=/images/author/john_hu_256e26af68e2f530.png alt="Author Image"><h5 class=author-name>Benny Temmerman</h5><p class=text-muted>Friday, January 16, 2026 | 19 minutes</p></div><div class=title><h1>SIEM data onboarding</h1></div><div class=tags><ul style=padding-left:0></ul></div><div class=post-content id=post-content><h1 id=siem-data-onboarding-best-practices-and-a-deepdive-into-splunk-vs-microsoft-sentinel>SIEM data onboarding: Best practices and a deepdive into Splunk vs Microsoft Sentinel</h1><h2 id=executive-summary>Executive summary</h2><p>Security Information and Event Management (SIEM) platforms are only as effective as the data they receive. SIEM data onboarding is the process of getting the right logs, in the right format, into the SIEM so it can detect threats, support incident response, and demonstrate compliance. Simply “sending some logs” is not enough; quality, completeness, and normalization drive the value you get from your SIEM investment.</p><p>Splunk and Microsoft Sentinel are two widely used SIEM platforms. They differ in how they ingest and manage data, but both require a disciplined onboarding approach. Splunk is highly flexible and can ingest virtually any data source with deep customization, while Sentinel is tightly integrated with Azure and Microsoft SaaS services, providing powerful native connectors. Neither tool will deliver value if onboarding is ad‑hoc or poorly governed.</p><p>From a business perspective, good data onboarding:</p><ul><li><p><strong>Reduces risk</strong> by increasing visibility into identity, endpoint, and network activity.</p></li><li><p><strong>Improves incident response</strong> by enabling faster, more accurate investigation.</p></li><li><p><strong>Controls cost</strong> by ensuring you ingest what you need, at the right volume and retention.</p></li><li><p><strong>Supports compliance</strong> with frameworks like ISO 27001:2022, NIST CSF 2.0, SOC 2 through auditable logging coverage.</p></li></ul><p>Leaders should treat SIEM data onboarding as a continuous program, not a one‑time project. It requires collaboration between the SOC, IT operations, application owners, and management. A clear onboarding strategy, supported by checklists and governance, will make Splunk or Sentinel significantly more effective and more cost‑efficient.</p><h2 id=introduction-why-data-onboarding-matters-for-siem-effectiveness>Introduction: Why data onboarding matters for SIEM effectiveness</h2><p>In a SIEM context, data onboarding is the end‑to‑end process of:<br>Connecting log sources -> Parsing raw events -> Normalizing fields into a common schema -> Enriching with context (e.g., asset, user, threat intel) -> Validating completeness and quality</p><p>This is very different from “just sending logs” via syslog or an agent. Raw, unparsed logs may technically arrive in the SIEM, but:
Fields won’t be extracted consistently -> Correlation rules won’t work reliably + Dashboards and KPIs will be wrong or misleading + Investigations will be slow and error‑prone.</p><p><strong>Poor onboarding</strong> leads directly to:</p><ul><li><p><strong>Missed detections</strong> – key fields like user, IP, hostname, or action are missing or incorrect.</p></li><li><p><strong>Alert fatigue</strong> – noisy or low‑value logs generate overwhelming, low‑signal alerts.</p></li><li><p><strong>Inaccurate reporting</strong> – compliance or management dashboards cannot be trusted.</p></li><li><p><strong>Compliance blind spots</strong> – you think you log critical systems, but the data is incomplete or misconfigured.</p></li></ul><blockquote><p><strong>Beginner note:</strong> If you’re new to SIEM, think of data onboarding as “teaching” your SIEM what your logs mean, so it can recognize suspicious behavior consistently across different systems.</p></blockquote><h2 id=what-is-data-onboarding-and-what-are-common-log-sources>What is data onboarding and what are common log sources?</h2><p>Proper <strong>SIEM data onboarding</strong> includes the following stages:</p><ol><li><p><strong>Connectivity:</strong> Agents, forwarders, APIs, syslog, cloud connectors.</p></li><li><p><strong>Parsing:</strong> Extracting structured fields from raw text (e.g., source IP, user, action).</p></li><li><p><strong>Normalization:</strong> Mapping fields into a common schema/data model (e.g., “src_ip” vs “SourceIP”).</p></li><li><p><strong>Enrichment:</strong> Adding context like asset criticality, user roles, threat intel, geo‑IP.</p></li><li><p><strong>Tagging:</strong> Applying tags such as authentication, network, endpoint for classification.</p></li><li><p><strong>Validation & monitoring:</strong> Verifying data volume, field population, error rates, and coverage over time.</p></li></ol><h3 id=azure-ad-logs>Azure AD logs</h3><p>Azure AD (Entra ID) logs provide insight into:</p><ul><li><p>User sign‑ins and authentication events</p></li><li><p>Conditional access outcomes</p></li><li><p>MFA success/failure</p></li><li><p>Application and resource access</p></li></ul><p>Typical security‑relevant fields:</p><ul><li><p>User principal name (userPrincipalName)</p></li><li><p>IP address / location</p></li><li><p>Application ID and client</p></li><li><p>Authentication result (success/failure)</p></li><li><p>Conditional access policies applied</p></li></ul><h3 id=firewall-logs>Firewall logs</h3><p>Firewall logs capture:</p><ul><li><p>Allowed and denied traffic</p></li><li><p>Source and destination IPs and ports</p></li><li><p>Protocol, action, and sometimes application identity</p></li></ul><p>Typical security‑relevant fields:</p><ul><li><p>src_ip, dest_ip, src_port, dest_port</p></li><li><p>Action (allow/deny)</p></li><li><p>Rule name or policy ID</p></li><li><p>Bytes sent/received</p></li><li><p>Interface or zone</p></li></ul><h3 id=edr-logs>EDR logs</h3><p>Endpoint detection & response logs surface:</p><ul><li><p>Process creation trees</p></li><li><p>File modifications and drops</p></li><li><p>Registry changes</p></li><li><p>Network connections initiated by processes</p></li><li><p>Security alerts from the EDR engine</p></li></ul><p>Typical security‑relevant fields:</p><ul><li><p>Hostname / device ID</p></li><li><p>User context</p></li><li><p>Parent and child processes</p></li><li><p>File hash, path, and reputation</p></li><li><p>Alert severity and category</p></li></ul><blockquote><p><strong>Beginner note:</strong> Azure AD, firewall, and EDR telemetry together give you visibility into <strong>identity</strong>, <strong>network</strong>, and <strong>endpoint</strong>, which are the three pillars of most modern detection strategies.</p></blockquote><h2 id=common-challenges-and-pitfalls-in-log-onboarding>Common challenges and pitfalls in log onboarding</h2><h3 id=1-incomplete-log-coverage>1. Incomplete log coverage</h3><p><strong>Problem:</strong> Critical sources (e.g., Azure AD, key firewalls, production EDR) are not onboarded or only partially onboarded.</p><p><strong>Impact:</strong></p><ul><li><p>Blind spots in authentication and identity‑based attacks.</p></li><li><p>Inability to reconstruct attack paths across network boundaries.</p></li><li><p>Gaps in incident timelines.</p></li></ul><p>**Example:**An account is compromised in Azure AD. Sign‑ins from unusual geo‑locations are logged, but Azure AD logs were never onboarded into the SIEM. The SOC only sees EDR alerts after the attacker reaches endpoints, missing early detection opportunities.</p><h3 id=2-poor-parsing-and-field-extraction>2. Poor parsing and field extraction</h3><p><strong>Problem:</strong> Logs are ingested as raw text; fields are not extracted consistently.</p><p><strong>Impact:</strong></p><ul><li><p>Detection rules that rely on specific fields (e.g., src_ip) fail or are unreliable.</p></li><li><p>Dashboards show incorrect or aggregated values.</p></li></ul><p>**Example:**Firewall logs arrive as unparsed syslog messages. A correlation rule looking for repeated denied connections from the same IP fails because the src_ip field is not correctly extracted.</p><h3 id=3-lack-of-normalization-across-tools>3. Lack of normalization across tools</h3><p><strong>Problem:</strong> Different vendors use different field names and formats, and no common schema is enforced.</p><p><strong>Impact:</strong></p><ul><li><p>Correlation rules must be rewritten per source.</p></li><li><p>Use case content is not reusable.</p></li><li><p>Threat hunting queries become very complex.</p></li></ul><p>**Example:**In Splunk, one data source uses src_ip, another uses source_ip. Sentinel has SrcIpAddr. Without a normalized model, a hunting query must account for all variants, increasing complexity and risk of errors.</p><h3 id=4-incorrect-time-zones-and-host-identification>4. Incorrect time zones and host identification</h3><p><strong>Problem:</strong> Time zones are misconfigured, or hostnames/IPs are inconsistent.</p><p><strong>Impact:</strong></p><ul><li><p>Incident timelines are misleading.</p></li><li><p>Event correlation across systems breaks.</p></li></ul><p>**Example:**Firewall logs are in UTC, EDR logs in local time, Azure AD in another format. When the SOC reconstructs an attack, events appear out of order, suggesting impossible sequences and confusing investigators.</p><h3 id=5-high-volume-low-value-logs>5. High-volume, low-value Logs</h3><p><strong>Problem:</strong> High‑volume logs (e.g., verbose debug logs) are ingested without clear use cases.</p><p><strong>Impact:</strong></p><ul><li><p>Storage and ingestion costs spike.</p></li><li><p>Noise overwhelms detections.</p></li><li><p>SOC time is wasted on low‑value data.</p></li></ul><p>**Example:**Verbose firewall “allow” logs are onboarded at full volume, but the SOC only has use cases for denied connections. Costs rise, but detection value does not.</p><h3 id=6-no-documentation-of-onboarding-decisions>6. No documentation of onboarding decisions</h3><p><strong>Problem:</strong> No clear record of which data sources are onboarded, why, and how.</p><p><strong>Impact:</strong></p><ul><li><p>Difficult to prove coverage for audits.</p></li><li><p>Hard to evaluate gaps or onboard new sources.</p></li></ul><p>**Example:**An auditor asks for evidence that all critical identity systems are logged. The organization cannot easily show which identity sources are in the SIEM, for how long, and under which use cases.</p><h2 id=best-practices-for-onboarding-logs-into-any-siem>Best practices for onboarding logs into any SIEM</h2><h3 id=1-prioritize-critical-sources>1. Prioritize critical sources</h3><ul><li><p><strong>Identity</strong>: Azure AD / Entra ID, on‑prem AD.</p></li><li><p><strong>Endpoint</strong>: EDR/XDR telemetry.</p></li><li><p><strong>Network perimeter</strong>: firewalls, VPNs, secure web gateways.</p></li><li><p><strong>Core infrastructure</strong>: domain controllers, critical servers.</p></li></ul><h3 id=2-define-usecases-before-onboarding>2. Define usecases before onboarding</h3><ul><li><p>Identify key detection scenarios you want to support.</p></li><li><p>Map them to required log sources and fields.</p></li><li><p>Onboard only those logs that support real use cases or compliance needs.</p></li></ul><h3 id=3-establish-a-common-event-schema--data-model>3. Establish a common event schema / data model</h3><ul><li><p>Define standard field names and types (e.g., src_ip, dest_ip, user, hostname, action).</p></li><li><p>Align with:</p><ul><li><p>Splunk CIM categories (authentication, endpoint, network, etc.).</p></li><li><p>Sentinel tables and, where applicable, ASIM (Advanced Security Information Model).</p></li></ul></li><li><p>Enforce this across sources as much as feasible.</p></li></ul><h3 id=4-treat-parsing-normalization-and-enrichment-as-firstclass>4. Treat parsing, normalization, and enrichment as first‑class</h3><ul><li><p>Invest in:</p><ul><li><p>Parsers (regex, vendor‑provided add‑ons, connectors).</p></li><li><p>Enrichment (asset CMDB, user identity, threat intel).</p></li></ul></li><li><p>Design onboarding pipelines to include <strong>validation</strong> (field completeness, error logging).</p></li></ul><blockquote><p><strong>Beginner note:</strong> Normalization means different log formats are mapped into a consistent field set, so one query can work across many sources.</p></blockquote><h3 id=5-monitor-data-quality-continuously>5. Monitor data quality continuously</h3><ul><li><p>Track:</p><ul><li><p>Ingestion volume per source.</p></li><li><p>Percentage of events with key fields populated.</p></li><li><p>Parser error rates.</p></li></ul></li><li><p>Regularly review:</p><ul><li><p>Whether logs still support current use cases.</p></li><li><p>Whether cost aligns with value.</p></li></ul></li></ul><blockquote><p>**Beginner note – “Garbage in, garbage out”:**If raw logs are incomplete or poorly structured, your SIEM’s analytics and detections will be unreliable, no matter how advanced the tool is.</p></blockquote><h3 id=6-align-with-common-frameworks-without-legal-guarantees>6. Align with common frameworks (without legal guarantees)</h3><ul><li><p>Map log coverage and onboarding practices to:</p><ul><li><p><strong>ISO 27001</strong> Annex A controls related to logging and monitoring.</p></li><li><p><strong>NIST CSF</strong> Detect/respond functions.</p></li><li><p><strong>SOC 2</strong> Security and availability criteria.</p></li></ul></li><li><p>Avoid “this guarantees compliance” language; instead say:</p><ul><li>“These practices support alignment with…”</li></ul></li></ul><h2 id=splunk-vs-microsoft-sentinel--data-onboarding-workflows-and-examples>Splunk vs Microsoft Sentinel – Data onboarding workflows and examples</h2><h3 id=onboarding-mechanisms>Onboarding mechanisms</h3><p><strong>Splunk:</strong></p><ul><li><p><strong>Forwarders</strong> (Universal/Heavy) installed on servers or collectors.</p></li><li><p><strong>HTTP Event Collector (HEC)</strong> for custom or cloud applications.</p></li><li><p><strong>Apps/Add‑ons</strong> from Splunkbase for specific products (e.g., Microsoft, firewalls, EDR).</p></li><li><p>Typically involves:</p><ul><li><p>Configuring input (e.g., inputs.conf).</p></li><li><p>Assigning sourcetype, index, and metadata.</p></li><li><p>Applying props/transforms for parsing and field extraction.</p></li></ul></li></ul><p><strong>Microsoft Sentinel:</strong></p><ul><li><p>Built on <strong>log analytics workspaces</strong>.</p></li><li><p><strong>Data connectors</strong> for Azure services, Microsoft 365, and third parties.</p></li><li><p>Supports:</p><ul><li><p>Azure agents / AMA.</p></li><li><p>Syslog/CEF connectors.</p></li><li><p>Direct API ingestion and custom logs.</p></li></ul></li><li><p>Typically involves:</p><ul><li><p>Enabling connector in Sentinel.</p></li><li><p>Configuring source (e.g., Azure subscription, M365 tenant, syslog server).</p></li><li><p>Mapping to relevant tables (e.g., SigninLogs, SecurityEvent, CommonSecurityLog).</p></li></ul></li></ul><h3 id=a-azure-ad-logs--onboarding-and-example-queries>a. Azure AD Logs – Onboarding and example queries</h3><h4 id=azure-ad-into-splunk>Azure AD into Splunk</h4><p>Common approaches:</p><ul><li><p>Splunk Add‑on for Microsoft cloud services or similar.</p></li><li><p>Pulling sign‑in and audit logs via Microsoft Graph API.</p></li><li><p>Assign sourcetype such as ms:azure:ad:signin.</p></li></ul><p>Typical fields (after parsing/normalization):</p><ul><li><p>user_principal_name</p></li><li><p>src_ip</p></li><li><p>location</p></li><li><p>result (Success/Failure)</p></li><li><p>app_display_name</p></li></ul><p><strong>Example SPL – Detect multiple failed logins from multiple countries (impossible travel indicator):</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>index<span style=color:#f92672>=</span>azure_ad sourcetype<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ms:azure:ad:signin&#34;</span> result<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Failure&#34;</span>  
</span></span><span style=display:flex><span>| stats dc<span style=color:#f92672>(</span>location_country<span style=color:#f92672>)</span> as distinct_countries, values<span style=color:#f92672>(</span>location_country<span style=color:#f92672>)</span> as countries, count as failed_attempts by user_principal_name, src_ip, _time  
</span></span><span style=display:flex><span>| where distinct_countries &gt; <span style=color:#ae81ff>1</span> AND failed_attempts &gt; <span style=color:#ae81ff>5</span>  
</span></span><span style=display:flex><span>| sort - failed_attempts
</span></span></code></pre></div><p><em>This query looks for users with failed Azure AD sign‑ins from multiple countries, indicating potential impossible travel or credential stuffing.</em></p><h4 id=azure-ad-into-sentinel>Azure AD into Sentinel</h4><ul><li><p>Use native Azure AD / Entra ID connectors in Sentinel.</p></li><li><p>Data typically lands in SigninLogs and AuditLogs tables.</p></li></ul><p><strong>Example KQL – Similar impossible travel logic:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>SigninLogs  
</span></span><span style=display:flex><span>| where ResultType !<span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>  // non-success  
</span></span><span style=display:flex><span>| summarize distinctCountries <span style=color:#f92672>=</span> dcount<span style=color:#f92672>(</span>LocationDetails.countryOrRegion<span style=color:#f92672>)</span>, countries <span style=color:#f92672>=</span> make_set<span style=color:#f92672>(</span>LocationDetails.countryOrRegion<span style=color:#f92672>)</span>, failedAttempts <span style=color:#f92672>=</span> count<span style=color:#f92672>()</span> by UserPrincipalName, IPAddress, bin<span style=color:#f92672>(</span>TimeGenerated, 1h<span style=color:#f92672>)</span>  
</span></span><span style=display:flex><span>| where distinctCountries &gt; <span style=color:#ae81ff>1</span> and failedAttempts &gt; <span style=color:#ae81ff>5</span>  
</span></span><span style=display:flex><span>| order by failedAttempts desc   <span style=color:#e6db74>`</span>
</span></span></code></pre></div><p><em>This KQL query identifies users with multiple failed sign‑ins from different countries within a given time window.</em></p><h3 id=b-firewall-logs--onboarding-and-example-queries>b. Firewall logs – Onboarding and example queries</h3><h4 id=firewalls-into-splunk>Firewalls into Splunk</h4><p>Typical approach:</p><ul><li><p>Send syslog to a syslog collector.</p></li><li><p>Use vendor‑specific Splunk Add‑on (e.g., for Palo Alto, Cisco ASA).</p></li><li><p>Assign appropriate sourcetype (e.g., pan:traffic, cisco:asa).</p></li></ul><p>Key fields (post‑CIM mapping):</p><ul><li><p>src_ip, dest_ip</p></li><li><p>src_port, dest_port</p></li><li><p>action (allowed/blocked)</p></li><li><p>app, rule</p></li></ul><p><strong>Example SPL – Blocked outbound traffic to known bad IPs:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>index<span style=color:#f92672>=</span>firewall sourcetype<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pan:traffic&#34;</span> action<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;deny&#34;</span>  
</span></span><span style=display:flex><span>| lookup threat_intel_bad_ips ip as dest_ip OUTPUTNEW category as threat_category  
</span></span><span style=display:flex><span>| search threat_category<span style=color:#f92672>=</span>*  
</span></span><span style=display:flex><span>| stats count by src_ip, dest_ip, threat_category, dest_port, app  
</span></span><span style=display:flex><span>| sort - count
</span></span></code></pre></div><p><em>This SPL identifies denied connections to IPs that appear in a threat intel list, grouped by source and destination.</em></p><h4 id=firewalls-into-sentinel>Firewalls into Sentinel</h4><p>Typical approach:</p><ul><li><p>Use Common Event Format (CEF) or Syslog connectors.</p></li><li><p>Logs often end up in CommonSecurityLog or vendor‑specific tables.</p></li></ul><p>Key fields:</p><ul><li><p>SourceIP, DestinationIP</p></li><li><p>SourcePort, DestinationPort</p></li><li><p>Action</p></li><li><p>DeviceAction, ApplicationProtocol</p></li></ul><p><strong>Example KQL – Similar detection for blocked outbound traffic to known bad IPs:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>CommonSecurityLog  
</span></span><span style=display:flex><span>| where DeviceAction <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;deny&#34;</span> or DeviceAction <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;blocked&#34;</span>  
</span></span><span style=display:flex><span>| lookup kind<span style=color:#f92672>=</span>leftouter ThreatIntelIndicator on $left.DestinationIP <span style=color:#f92672>==</span> $right.NetworkIP  
</span></span><span style=display:flex><span>| where isnotempty<span style=color:#f92672>(</span>ThreatType<span style=color:#f92672>)</span>  
</span></span><span style=display:flex><span>| summarize count<span style=color:#f92672>()</span> by SourceIP, DestinationIP, ThreatType, DestinationPort, ApplicationProtocol  
</span></span><span style=display:flex><span>| order by count_ desc
</span></span></code></pre></div><p><em>This KQL correlates denied firewall connections with threat intelligence indicators to find possible exfiltration or C2 attempts.</em></p><h3 id=c-edr-logs--onboarding-and-example-queries>c. EDR logs – Onboarding and example Queries</h3><h4 id=edr-into-splunk>EDR into Splunk</h4><p>Typical approach:</p><ul><li><p>Vendor‑specific Splunk apps/add‑ons or APIs (e.g., Microsoft Defender, CrowdStrike, etc.).</p></li><li><p>Events often assigned to endpoint category in CIM.</p></li></ul><p>Key fields:</p><ul><li><p>host, user</p></li><li><p>process_name, parent_process_name</p></li><li><p>file_path, file_hash</p></li><li><p>event_type (process_start, alert, network_connection)</p></li></ul><p><strong>Example SPL – Suspicious process tree (e.g., Office spawning PowerShell):</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>index<span style=color:#f92672>=</span>edr sourcetype<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;edr:process&#34;</span> event_type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;process_start&#34;</span>  
</span></span><span style=display:flex><span>| where like<span style=color:#f92672>(</span>parent_process_name, <span style=color:#e6db74>&#34;%winword.exe&#34;</span><span style=color:#f92672>)</span> AND like<span style=color:#f92672>(</span>process_name, <span style=color:#e6db74>&#34;%powershell.exe&#34;</span><span style=color:#f92672>)</span>  
</span></span><span style=display:flex><span>| stats count, values<span style=color:#f92672>(</span>file_path<span style=color:#f92672>)</span> as paths by host, user, parent_process_name, process_name  
</span></span><span style=display:flex><span>| where count &gt; <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p><em>This SPL finds instances where Microsoft Word spawns PowerShell, a common indicator of macro‑based attacks.</em></p><h4 id=edr-into-sentinel>EDR into Sentinel</h4><p>Typical approach:</p><ul><li><p>Use native connectors, e.g., Microsoft Defender for Endpoint.</p></li><li><p>Logs land in tables such as DeviceProcessEvents, DeviceEvents, SecurityAlert.</p></li></ul><p><strong>Example KQL – Office spawning PowerShell:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>DeviceProcessEvents  
</span></span><span style=display:flex><span>| where InitiatingProcessFileName in <span style=color:#f92672>(</span><span style=color:#e6db74>&#34;WINWORD.EXE&#34;</span>, <span style=color:#e6db74>&#34;EXCEL.EXE&#34;</span>, <span style=color:#e6db74>&#34;POWERPNT.EXE&#34;</span><span style=color:#f92672>)</span>  
</span></span><span style=display:flex><span>| where FileName <span style=color:#f92672>=</span>~ <span style=color:#e6db74>&#34;powershell.exe&#34;</span>  
</span></span><span style=display:flex><span>| summarize count<span style=color:#f92672>()</span>, any<span style=color:#f92672>(</span>InitiatingProcessCommandLine<span style=color:#f92672>)</span>, any<span style=color:#f92672>(</span>ProcessCommandLine<span style=color:#f92672>)</span> by DeviceName, InitiatingProcessFileName, FileName, InitiatingProcessAccountName  
</span></span><span style=display:flex><span>| where count_ &gt; <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p><em>This KQL identifies Office processes launching PowerShell on endpoints, a typical suspicious behavior pattern.</em></p><h2 id=data-mapping-and-normalization-field-mappings-schemas-parsing-tuning>Data mapping and normalization (Field mappings, schemas, parsing, tuning)</h2><h3 id=splunk-cim-common-information-model>Splunk: CIM (Common Information Model)</h3><ul><li><p>Splunk’s CIM defines standardized field names across domains:</p><ul><li><p>Authentication</p></li><li><p>Endpoint</p></li><li><p>Network traffic</p></li><li><p>Web, malware, etc.</p></li></ul></li><li><p>Add‑ons perform the heavy lifting:</p><ul><li><p>Parse vendor‑specific log formats.</p></li><li><p>Map fields to CIM.</p></li></ul></li></ul><h3 id=sentinel-tables-and-asim>Sentinel: Tables and ASIM</h3><ul><li><p>Sentinel uses structured tables (e.g., SigninLogs, SecurityEvent, CommonSecurityLog, DeviceProcessEvents).</p></li><li><p><strong>ASIM (Advanced Security Information Model)</strong> defines abstractions for certain data types (e.g., network sessions, DNS).</p></li></ul><h3 id=example-azure-ad-field-mapping>Example: Azure AD field mapping</h3><p>| Concept | Splunk Field (CIM) | Sentinel Field |
| User principal name | user / user_principal_name | UserPrincipalName |
| Source IP | src_ip | IPAddress |
| Result | result | ResultType, ResultDescription |
| Location | countrysrc_country | LocationDetails.countryOrRegion |</p><h3 id=query-before-vs-after-normalization>Query before vs after normalization</h3><p><strong>Before normalization (Splunk – multiple Azure sources):</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>index<span style=color:#f92672>=</span>azure_ad OR index<span style=color:#f92672>=</span>legacy_identity  
</span></span><span style=display:flex><span>| eval user<span style=color:#f92672>=</span>coalesce<span style=color:#f92672>(</span>user_principal_name, username, upn<span style=color:#f92672>)</span>  
</span></span><span style=display:flex><span>| eval src_ip<span style=color:#f92672>=</span>coalesce<span style=color:#f92672>(</span>src_ip, ipAddress, client_ip<span style=color:#f92672>)</span>  
</span></span><span style=display:flex><span>| search user<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;alice@contoso.com&#34;</span>
</span></span></code></pre></div><p><strong>After normalization (Splunk – CIM aligned):</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>index<span style=color:#f92672>=</span>identity  tag<span style=color:#f92672>=</span>authentication  user<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;alice@contoso.com&#34;</span>   <span style=color:#e6db74>`</span>
</span></span></code></pre></div><p><em>After mapping, queries become simpler and more reusable across sources.</em></p><p><strong>Before normalization (Sentinel – different tables):</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>SigninLogs  
</span></span><span style=display:flex><span>| where UserPrincipalName <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;alice@contoso.com&#34;</span>  
</span></span><span style=display:flex><span>| union AuditLogs  
</span></span><span style=display:flex><span>| where Identity <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;alice@contoso.com&#34;</span>
</span></span></code></pre></div><p><strong>After ASIM/normalized view (conceptual example):</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>imSignin  
</span></span><span style=display:flex><span>| where User <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;alice@contoso.com&#34;</span>
</span></span></code></pre></div><p><em>(Assuming use of ASIM or custom views that provide a unified schema for sign‑in events.)</em></p><h3 id=parsing-and-tuning>Parsing and tuning</h3><p>Key practices:</p><ul><li><p><strong>Adjust field extractions/parsers:</strong></p><ul><li><p>In Splunk, tune props.conf and transforms.conf.</p></li><li><p>In Sentinel, ensure correct CEF mapping or custom parsing for CustomLogs.</p></li></ul></li><li><p><strong>Handle noisy events:</strong></p><ul><li><p>Implement filters at source or in ingestion rules.</p></li><li><p>Exclude verbose debug logs where no usecases exist.</p></li></ul></li><li><p><strong>Validate key fields:</strong></p><ul><li><p>Require user, host, src_ip, dest_ip, action, and timestamp for key use cases.</p></li><li><p>Alert on sudden drops in field population.</p></li></ul></li></ul><h2 id=realistic-scenarios--usecases>Realistic scenarios / usecases</h2><h3 id=1-compromised-user-account-in-azure-ad>1. Compromised user account in Azure AD</h3><p><strong>Narrative:</strong> An attacker obtains credentials for a user. They sign in from unusual locations, fail MFA repeatedly, and eventually succeed.</p><p><strong>Critical logs and fields:</strong></p><ul><li><p>Azure AD / Entra ID:</p><ul><li>UserPrincipalName, IPAddress, LocationDetails.countryOrRegion, ResultType, AuthenticationRequirement</li></ul></li><li><p>EDR (later stages, lateral movement):</p><ul><li>DeviceName, process events, alerts</li></ul></li></ul><p><strong>Splunk SPL – Detect suspicious sign‑ins followed by success:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>index<span style=color:#f92672>=</span>azure_ad sourcetype<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ms:azure:ad:signin&#34;</span>  
</span></span><span style=display:flex><span>| eval result<span style=color:#f92672>=</span><span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>ResultType<span style=color:#f92672>==</span>0,<span style=color:#e6db74>&#34;Success&#34;</span>,<span style=color:#e6db74>&#34;Failure&#34;</span><span style=color:#f92672>)</span>  
</span></span><span style=display:flex><span>| transaction user_principal_name maxspan<span style=color:#f92672>=</span>1h startswith<span style=color:#f92672>=(</span>result<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Failure&#34;</span><span style=color:#f92672>)</span> endswith<span style=color:#f92672>=(</span>result<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Success&#34;</span><span style=color:#f92672>)</span>  
</span></span><span style=display:flex><span>| where like<span style=color:#f92672>(</span>countries, <span style=color:#e6db74>&#34;%Unknown%&#34;</span><span style=color:#f92672>)</span> OR mvcount<span style=color:#f92672>(</span>countries<span style=color:#f92672>)</span> &gt; <span style=color:#ae81ff>1</span>  
</span></span><span style=display:flex><span>| table _time, user_principal_name, countries, src_ip, result
</span></span></code></pre></div><p><em>This SPL looks for sequences of failed then successful sign‑ins within an hour, from varying or unknown locations.</em></p><p><strong>Sentinel KQL – Similar pattern:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>let FailedLogons <span style=color:#f92672>=</span> SigninLogs  
</span></span><span style=display:flex><span>| where ResultType !<span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>  
</span></span><span style=display:flex><span>| project UserPrincipalName, IPAddress, Location <span style=color:#f92672>=</span> LocationDetails.countryOrRegion, TimeGenerated;  
</span></span><span style=display:flex><span>let SuccessfulLogons <span style=color:#f92672>=</span>  SigninLogs  
</span></span><span style=display:flex><span>| where ResultType <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>  
</span></span><span style=display:flex><span>| project UserPrincipalName, IPAddress, Location <span style=color:#f92672>=</span> LocationDetails.countryOrRegion, TimeGenerated;  
</span></span><span style=display:flex><span>FailedLogons  
</span></span><span style=display:flex><span>| join kind<span style=color:#f92672>=</span>inner <span style=color:#f92672>(</span>SuccessfulLogons<span style=color:#f92672>)</span> on UserPrincipalName  
</span></span><span style=display:flex><span>| where SuccessfulLogons_TimeGenerated between <span style=color:#f92672>(</span>FailedLogons_TimeGenerated .. FailedLogons_TimeGenerated + 1h<span style=color:#f92672>)</span>  
</span></span><span style=display:flex><span>| where FailedLogons_Location !<span style=color:#f92672>=</span> SuccessfulLogons_Location
</span></span></code></pre></div><p><em>This KQL finds users with failed then successful logons within 1 hour from different locations.</em></p><h3 id=2-suspicious-outbound-firewall-traffic-potential-exfiltration>2. Suspicious outbound firewall traffic (potential exfiltration)</h3><p><strong>Narrative:</strong> A compromised host starts sending large volumes of outbound traffic to unknown, potentially malicious IPs over unusual ports.</p><p><strong>Critical logs and fields:</strong></p><ul><li><p>Firewall:</p><ul><li>src_ip, dest_ip, dest_port, bytes_out, action</li></ul></li><li><p>EDR (optional):</p><ul><li>Process initiating connections</li></ul></li><li><p>Threat intelligence:</p><ul><li>Known bad or suspicious IPs/domains</li></ul></li></ul><p><strong>Splunk SPL – High volume denied outbound traffic:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>index<span style=color:#f92672>=</span>firewall action<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;deny&#34;</span>  
</span></span><span style=display:flex><span>| stats sum<span style=color:#f92672>(</span>bytes_out<span style=color:#f92672>)</span> as total_bytes, count as event_count by src_ip, dest_ip, dest_port  
</span></span><span style=display:flex><span>| where total_bytes &gt; <span style=color:#ae81ff>10000000</span> OR event_count &gt; <span style=color:#ae81ff>1000</span>  
</span></span><span style=display:flex><span>| sort - total_bytes
</span></span></code></pre></div><p><em>This SPL identifies source IPs sending large amounts of denied outbound traffic, which might indicate exfiltration attempts.</em></p><p><strong>Sentinel KQL – Similar detection:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>CommonSecurityLog  
</span></span><span style=display:flex><span>| where DeviceAction in <span style=color:#f92672>(</span><span style=color:#e6db74>&#34;deny&#34;</span>, <span style=color:#e6db74>&#34;block&#34;</span><span style=color:#f92672>)</span>  
</span></span><span style=display:flex><span>| summarize totalBytes <span style=color:#f92672>=</span> sum<span style=color:#f92672>(</span>toint<span style=color:#f92672>(</span>BytesSent<span style=color:#f92672>))</span>, eventCount <span style=color:#f92672>=</span> count<span style=color:#f92672>()</span> by SourceIP, DestinationIP, DestinationPort  
</span></span><span style=display:flex><span>| where totalBytes &gt; <span style=color:#ae81ff>10000000</span> or eventCount &gt; <span style=color:#ae81ff>1000</span>  
</span></span><span style=display:flex><span>| order by totalBytes desc
</span></span></code></pre></div><p><em>This KQL finds blocked outbound connections with unusually high traffic volume.</em></p><h3 id=3-postexploitation-activity-in-edr-logs>3. Post‑exploitation activity in EDR logs</h3><p><strong>Narrative:</strong> After gaining a foothold, an attacker executes malicious tools and uses lateral movement techniques from compromised endpoints.</p><p><strong>Critical logs and fields:</strong></p><ul><li><p>EDR:</p><ul><li>Process creation, network connections, alerts, user context.</li></ul></li><li><p>Azure AD:</p><ul><li>Possible concurrent abnormal sign‑ins.</li></ul></li><li><p>Firewall:</p><ul><li>East‑west traffic, SMB/RDP, unusual ports.</li></ul></li></ul><p><strong>Splunk SPL – Hunting for suspicious tools (e.g., psexec, wmic):</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>index<span style=color:#f92672>=</span>edr sourcetype<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;edr:process&#34;</span>  event_type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;process_start&#34;</span>  
</span></span><span style=display:flex><span>| search process_name IN <span style=color:#f92672>(</span><span style=color:#e6db74>&#34;psexec.exe&#34;</span>,<span style=color:#e6db74>&#34;wmic.exe&#34;</span>,<span style=color:#e6db74>&#34;wmiprvse.exe&#34;</span><span style=color:#f92672>)</span>  
</span></span><span style=display:flex><span>| stats count, values<span style=color:#f92672>(</span>parent_process_name<span style=color:#f92672>)</span> as parents, values<span style=color:#f92672>(</span>file_path<span style=color:#f92672>)</span> as paths by host, user, process_name  
</span></span><span style=display:flex><span>| where count &gt; <span style=color:#ae81ff>3</span>
</span></span></code></pre></div><p><em>This SPL hunts for repeated execution of lateral movement tools across hosts.</em></p><p><strong>Sentinel KQL – Similar EDR hunt:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>DeviceProcessEvents  
</span></span><span style=display:flex><span>| where FileName in <span style=color:#f92672>(</span><span style=color:#e6db74>&#34;psexec.exe&#34;</span>, <span style=color:#e6db74>&#34;wmic.exe&#34;</span>, <span style=color:#e6db74>&#34;wmiprvse.exe&#34;</span><span style=color:#f92672>)</span>  
</span></span><span style=display:flex><span>| summarize count<span style=color:#f92672>()</span>, parentProcs <span style=color:#f92672>=</span> make_set<span style=color:#f92672>(</span>InitiatingProcessFileName<span style=color:#f92672>)</span>, paths <span style=color:#f92672>=</span> make_set<span style=color:#f92672>(</span>FolderPath<span style=color:#f92672>)</span> by DeviceName, InitiatingProcessAccountName, FileName  
</span></span><span style=display:flex><span>| where count_ &gt; <span style=color:#ae81ff>3</span>
</span></span></code></pre></div><p><em>This KQL finds frequent use of tools commonly associated with lateral movement.</em></p><p>In all cases, <strong>success or failure of these detections</strong> depends heavily on:</p><ul><li><p>Azure AD, firewall, and EDR logs being properly onboarded.</p></li><li><p>Key fields (user, IP, host, process) being correctly parsed and normalized.</p></li><li><p>Ensuring time synchronization and a unified schema.</p></li></ul><h2 id=cost-scalability-and-operational-aspects-of-ingestion>Cost, scalability, and operational aspects of ingestion</h2><h3 id=conceptual-cost-models>Conceptual cost models</h3><ul><li><p><strong>Splunk:</strong></p><ul><li><p>Typically licenses based on ingested data volume (and/or infrastructure/host‑based models, depending on edition).</p></li><li><p>High‑volume logs have direct cost implications.</p></li></ul></li><li><p><strong>Sentinel:</strong></p><ul><li>Built on Azure Log Analytics; pricing is largely per GB of data ingested and retained, with options for reserved capacity and archive tiers.</li></ul></li></ul><blockquote><p>Avoid relying on specific pricing numbers: refer to official vendor documentation, as models and rates may change.</p></blockquote><h3 id=retention-and-storage>Retention and storage</h3><ul><li><p><strong>Splunk:</strong></p><ul><li>Hot/warm/cold/frozen buckets; data roll‑off and archival controlled by index settings.</li></ul></li><li><p><strong>Sentinel:</strong></p><ul><li>Configurable retention per workspace/table, with options for long‑term archive and search.</li></ul></li></ul><h3 id=strategies-to-reduce-cost-without-losing-value>Strategies to reduce cost without losing value</h3><ul><li><p>Prioritize must‑have vs nice‑to‑have logs.</p></li><li><p>Filter unneeded events at source (e.g., debug logs).</p></li><li><p>Use summaries or metrics where raw detail is not always required.</p></li><li><p>Use differential retention:</p><ul><li><p>Shorter retention for high‑volume, low‑value logs.</p></li><li><p>Longer retention for critical security and compliance data.</p></li></ul></li></ul><h3 id=scalability-and-operations>Scalability and operations</h3><ul><li><p><strong>Splunk:</strong></p><ul><li><p>Scale out indexers and search heads.</p></li><li><p>Requires capacity planning for on‑prem or IaaS deployments.</p></li></ul></li><li><p><strong>Sentinel:</strong></p><ul><li><p>Built on Azure infrastructure; scaling is largely handled by the platform.</p></li><li><p>Still requires planning around workspace design, regionality, and performance.</p></li></ul></li></ul><h3 id=practical-tips>Practical tips</h3><ul><li><p>Regularly review ingestion by:</p><ul><li><p>Index / table</p></li><li><p>Log source type</p></li><li><p>Use case mapping</p></li></ul></li><li><p>Involve finance / cost management teams to align SIEM ingestion strategy with budget and risk appetite.</p></li></ul><h2 id=stakeholder-informing-and-collaboration>Stakeholder informing and collaboration</h2><p>SIEM data onboarding is not just for the SOC; it involves multiple stakeholders:</p><ul><li><p><strong>SOC / Security engineering</strong> – defines usecases and detection logic.</p></li><li><p><strong>IT operations / Infrastructure</strong> – implements connectors, forwarders, agents.</p></li><li><p><strong>Application owners</strong> – provide understanding of application logs and criticality.</p></li><li><p><strong>Security leadership / CISO</strong> – sets priorities and risk tolerance.</p></li><li><p><strong>Compliance / Risk</strong> – aligns logging with regulatory or policy requirements.</p></li></ul><h3 id=communicating-with-managers-and-csuite>Communicating with managers and C‑suite</h3><ul><li><p>Frame onboarding in terms of:</p><ul><li><p>Risk reduction and incident response readiness.</p></li><li><p>Cost vs. visibility – what business risks are mitigated by specific log sources.</p></li><li><p>Compliance posture and audit readiness.</p></li></ul></li></ul><h3 id=success-metrics>Success metrics</h3><ul><li><p>Percentage of critical systems with fully onboarded logging.</p></li><li><p>Coverage of high‑priority use cases.</p></li><li><p>Time‑to‑detect and time‑to‑respond metrics.</p></li><li><p>Reduction in false positives due to better normalization and tuning.</p></li></ul><h3 id=simple-stakeholder-communication-template>Simple Stakeholder Communication Template</h3><p>You can use a simple table or slide format like:</p><p>| Item | Description |
| Business objective | e.g., Detect account takeover in Azure AD |
| Critical log sources | Azure AD, EDR, VPN, firewall |
| Onboarding status | Azure AD & EDR onboarded; VPN in progress |
| Key fields required | User, IP, device, location, MFA result |
| Cost considerations | Est. X GB/day; options to filter low‑value events |
| Risks if not onboarded | Missed early compromise, delayed incident response |
| Next steps & owners | SOC + Identity team to finalize onboarding by <date>|</p><h2 id=practical-siem-data-onboarding-checklist>Practical SIEM data onboarding checklist</h2><p>Use this tool‑neutral checklist to drive your program. Add Splunk/Sentinel specifics where appropriate.</p><ol><li><p><strong>Identify critical log sources</strong></p><ul><li><p>[ ] Azure AD / Entra ID</p></li><li><p>[ ] EDR/XDR</p></li><li><p>[ ] Firewalls and VPNs</p></li><li><p>[ ] Domain controllers and key infrastructure</p></li><li><p><strong>Splunk note:</strong> Map each to appropriate indexes and sourcetype.</p></li><li><p><strong>Sentinel note:</strong> Map each to correct connectors and tables.</p></li></ul></li><li><p><strong>Define detection usecases</strong></p><ul><li><p>[ ] List primary threats (e.g., account takeover, lateral movement, exfiltration).</p></li><li><p>[ ] Map each threat to required log sources and fields.</p></li><li><p>[ ] Prioritize based on risk and feasibility.</p></li></ul></li><li><p><strong>Design normalization and data model</strong></p><ul><li><p>[ ] Define standard field names (user, host, src_ip, dest_ip, action).</p></li><li><p>[ ] For Splunk: align with relevant <strong>CIM data models</strong>.</p></li><li><p>[ ] For Sentinel: align with table schemas and <strong>ASIM</strong> where applicable.</p></li><li><p>[ ] Document mappings per source.</p></li></ul></li><li><p><strong>Configure and test ingestion</strong></p><ul><li><p>[ ] Set up connectors/forwarders/agents.</p></li><li><p>[ ] Validate data arrives in expected index/table.</p></li><li><p>[ ] Verify parsers extract all required fields.</p></li><li><p>[ ] Confirm timestamps and time zones are correct.</p></li></ul></li><li><p><strong>Validate fields & data quality</strong></p><ul><li><p>[ ] Check % of events with key fields populated.</p></li><li><p>[ ] Validate event volumes vs expectations.</p></li><li><p>[ ] Monitor parser errors and fix recurring issues.</p></li></ul></li><li><p><strong>Tune for noise and cost</strong></p><ul><li><p>[ ] Filter out low‑value events where no use cases exist.</p></li><li><p>[ ] Adjust retention by source and index/table.</p></li><li><p>[ ] Periodically review ingestion vs detected incidents.</p></li></ul></li><li><p><strong>Document and govern</strong></p><ul><li><p>[ ] Maintain a central inventory of onboarded sources.</p></li><li><p>[ ] Record purpose, use cases, and data mappings.</p></li><li><p>[ ] Review coverage and priorities quarterly with stakeholders.</p></li></ul></li><li><p><strong>Iterate and improve</strong></p><ul><li><p>[ ] Revisit use cases as the threat landscape evolves.</p></li><li><p>[ ] Validate detection performance and adjust data onboarding accordingly.</p></li><li><p>[ ] Align improvements with ISO 27001, NIST CSF, and SOC 2 where relevant (without treating them as guarantees).</p></li></ul></li></ol><h2 id=conclusion--call-to-action>Conclusion & call to action</h2><p>High‑quality <strong>SIEM data onboarding</strong> is the foundation of effective detection, response, and compliance. Splunk and Microsoft Sentinel both offer powerful capabilities, but they differ in how data is ingested, normalized, and managed:</p><ul><li><p>Splunk provides <strong>extreme flexibility</strong> through forwarders, HEC, and rich add‑ons, well‑suited for heterogeneous environments.</p></li><li><p>Sentinel provides <strong>deep native integration with Azure and Microsoft SaaS</strong>, simplifying onboarding for organizations heavily invested in the Microsoft ecosystem.</p></li></ul><p>Neither platform can compensate for poor data onboarding practices. If critical sources like Azure AD, firewall, and EDR are not properly parsed, normalized, and validated, your SIEM will miss threats, generate noise, and provide questionable reports.</p><p>A disciplined onboarding strategy—supported by a common schema, good parsers, continuous tuning, and cross‑stakeholder collaboration—turns Splunk or Sentinel into a reliable detection and investigation platform instead of an expensive log bucket.</p><p><strong>Next steps:</strong> Engage SOC, IT, and leadership teams in a structured onboarding plan that balances risk, visibility, and cost.</p><h3 id=faq>FAQ</h3><p><strong>1. What is SIEM data onboarding?</strong><br>SIEM data onboarding is the process of connecting log sources to a SIEM, parsing and normalizing events into a common schema, enriching them with context, and validating data quality so detections and investigations work reliably.</p><p><strong>2. Why is data onboarding important for SIEM effectiveness?</strong><br>Without proper onboarding, key fields may be missing or inconsistent, causing missed detections, noisy alerts, and unreliable dashboards. Good onboarding turns raw logs into actionable security telemetry.</p><p><strong>3. How do Splunk and Microsoft Sentinel differ in data onboarding?</strong><br>Splunk uses forwarders, HEC, and add‑ons for flexible ingestion across many environments. Sentinel relies on Log Analytics‑based connectors tightly integrated with Azure and Microsoft 365. Both require proper parsing and normalization to be effective.</p><p><strong>4. Which log sources should I onboard first to my SIEM?</strong><br>Typically start with identity (Azure AD/Entra ID, AD), endpoint (EDR), and network perimeter (firewalls, VPN). These sources provide the core visibility needed to detect account compromise, lateral movement, and data exfiltration.</p><p><strong>5. What is log normalization in SIEM?</strong><br>Normalization maps different vendor log formats into a common set of fields and schemas. This allows you to write reusable detection rules and hunting queries that work across multiple data sources.</p><p><strong>6. How can I control SIEM ingestion costs without losing detection value?</strong><br>Prioritize high‑value sources, filter low‑value events, tune verbose logs, apply tiered retention, and regularly review ingestion against your active detections and use cases. Both Splunk and Sentinel support strategies to balance cost with visibility.</p></div><div class="row ps-3 pe-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn icon-button bg-facebook" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fsiemforge.xyz%2fposts%2fsiem%2fdata-onboarding%2fdataonboardingpost%2f" target=_blank><i class="fab fa-facebook"></i>
</a><a class="btn icon-button bg-reddit" href="https://reddit.com/submit?url=https%3a%2f%2fsiemforge.xyz%2fposts%2fsiem%2fdata-onboarding%2fdataonboardingpost%2f&title=SIEM%20data%20onboarding" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn icon-button bg-linkedin" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fsiemforge.xyz%2fposts%2fsiem%2fdata-onboarding%2fdataonboardingpost%2f&title=SIEM%20data%20onboarding" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn icon-button bg-whatsapp" href="https://api.whatsapp.com/send?text=SIEM%20data%20onboarding https%3a%2f%2fsiemforge.xyz%2fposts%2fsiem%2fdata-onboarding%2fdataonboardingpost%2f" target=_blank><i class="fab fa-whatsapp"></i>
</a><a class="btn icon-button" href="mailto:?subject=SIEM%20data%20onboarding&body=https%3a%2f%2fsiemforge.xyz%2fposts%2fsiem%2fdata-onboarding%2fdataonboardingpost%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/bennytemmerman/toha/edit/main/content/posts/SIEM/Data%20onboarding/DataOnboardingPost.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/automation/n8n/firstautomationworkflow/ title="My first automation workflow" class="btn filled-button"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>My first automation workflow</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn type=button data-bs-toggle=tooltip data-bs-placement=left title="Scroll to top"><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center ps-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#executive-summary>Executive summary</a></li><li><a href=#introduction-why-data-onboarding-matters-for-siem-effectiveness>Introduction: Why data onboarding matters for SIEM effectiveness</a></li><li><a href=#what-is-data-onboarding-and-what-are-common-log-sources>What is data onboarding and what are common log sources?</a><ul><li><a href=#azure-ad-logs>Azure AD logs</a></li><li><a href=#firewall-logs>Firewall logs</a></li><li><a href=#edr-logs>EDR logs</a></li></ul></li><li><a href=#common-challenges-and-pitfalls-in-log-onboarding>Common challenges and pitfalls in log onboarding</a><ul><li><a href=#1-incomplete-log-coverage>1. Incomplete log coverage</a></li><li><a href=#2-poor-parsing-and-field-extraction>2. Poor parsing and field extraction</a></li><li><a href=#3-lack-of-normalization-across-tools>3. Lack of normalization across tools</a></li><li><a href=#4-incorrect-time-zones-and-host-identification>4. Incorrect time zones and host identification</a></li><li><a href=#5-high-volume-low-value-logs>5. High-volume, low-value Logs</a></li><li><a href=#6-no-documentation-of-onboarding-decisions>6. No documentation of onboarding decisions</a></li></ul></li><li><a href=#best-practices-for-onboarding-logs-into-any-siem>Best practices for onboarding logs into any SIEM</a><ul><li><a href=#1-prioritize-critical-sources>1. Prioritize critical sources</a></li><li><a href=#2-define-usecases-before-onboarding>2. Define usecases before onboarding</a></li><li><a href=#3-establish-a-common-event-schema--data-model>3. Establish a common event schema / data model</a></li><li><a href=#4-treat-parsing-normalization-and-enrichment-as-firstclass>4. Treat parsing, normalization, and enrichment as first‑class</a></li><li><a href=#5-monitor-data-quality-continuously>5. Monitor data quality continuously</a></li><li><a href=#6-align-with-common-frameworks-without-legal-guarantees>6. Align with common frameworks (without legal guarantees)</a></li></ul></li><li><a href=#splunk-vs-microsoft-sentinel--data-onboarding-workflows-and-examples>Splunk vs Microsoft Sentinel – Data onboarding workflows and examples</a><ul><li><a href=#onboarding-mechanisms>Onboarding mechanisms</a></li><li><a href=#a-azure-ad-logs--onboarding-and-example-queries>a. Azure AD Logs – Onboarding and example queries</a><ul><li><a href=#azure-ad-into-splunk>Azure AD into Splunk</a></li><li><a href=#azure-ad-into-sentinel>Azure AD into Sentinel</a></li></ul></li><li><a href=#b-firewall-logs--onboarding-and-example-queries>b. Firewall logs – Onboarding and example queries</a><ul><li><a href=#firewalls-into-splunk>Firewalls into Splunk</a></li><li><a href=#firewalls-into-sentinel>Firewalls into Sentinel</a></li></ul></li><li><a href=#c-edr-logs--onboarding-and-example-queries>c. EDR logs – Onboarding and example Queries</a><ul><li><a href=#edr-into-splunk>EDR into Splunk</a></li><li><a href=#edr-into-sentinel>EDR into Sentinel</a></li></ul></li></ul></li><li><a href=#data-mapping-and-normalization-field-mappings-schemas-parsing-tuning>Data mapping and normalization (Field mappings, schemas, parsing, tuning)</a><ul><li><a href=#splunk-cim-common-information-model>Splunk: CIM (Common Information Model)</a></li><li><a href=#sentinel-tables-and-asim>Sentinel: Tables and ASIM</a></li><li><a href=#example-azure-ad-field-mapping>Example: Azure AD field mapping</a></li><li><a href=#query-before-vs-after-normalization>Query before vs after normalization</a></li><li><a href=#parsing-and-tuning>Parsing and tuning</a></li></ul></li><li><a href=#realistic-scenarios--usecases>Realistic scenarios / usecases</a><ul><li><a href=#1-compromised-user-account-in-azure-ad>1. Compromised user account in Azure AD</a></li><li><a href=#2-suspicious-outbound-firewall-traffic-potential-exfiltration>2. Suspicious outbound firewall traffic (potential exfiltration)</a></li><li><a href=#3-postexploitation-activity-in-edr-logs>3. Post‑exploitation activity in EDR logs</a></li></ul></li><li><a href=#cost-scalability-and-operational-aspects-of-ingestion>Cost, scalability, and operational aspects of ingestion</a><ul><li><a href=#conceptual-cost-models>Conceptual cost models</a></li><li><a href=#retention-and-storage>Retention and storage</a></li><li><a href=#strategies-to-reduce-cost-without-losing-value>Strategies to reduce cost without losing value</a></li><li><a href=#scalability-and-operations>Scalability and operations</a></li><li><a href=#practical-tips>Practical tips</a></li></ul></li><li><a href=#stakeholder-informing-and-collaboration>Stakeholder informing and collaboration</a><ul><li><a href=#communicating-with-managers-and-csuite>Communicating with managers and C‑suite</a></li><li><a href=#success-metrics>Success metrics</a></li><li><a href=#simple-stakeholder-communication-template>Simple Stakeholder Communication Template</a></li></ul></li><li><a href=#practical-siem-data-onboarding-checklist>Practical SIEM data onboarding checklist</a></li><li><a href=#conclusion--call-to-action>Conclusion & call to action</a><ul><li><a href=#faq>FAQ</a></li></ul></li></ul></nav></div></div></section></div><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "c845fbe0ec8f4fe1b3d3db62cc771051"}'></script><script src=/application.fda7b48a8d3c362b0b790a3314272696a7a899a2e1ea88f0bfb6823f2191c23c.js integrity="sha256-/ae0io08NisLeQozFCcmlqeomaLh6ojwv7aCPyGRwjw=" defer></script></body></html>