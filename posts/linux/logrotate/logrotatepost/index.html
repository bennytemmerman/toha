<!doctype html><html lang=en><head><title>Logrotate</title><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.357dd1de946e0748ed1ed88009a6203f270bccbdabe5793ab4aab15964be163a.css integrity="sha256-NX3R3pRuB0jtHtiACaYgPycLzL2r5Xk6tKqxWWS+Fjo="><link rel=icon type=image/png href=/images/site/favicon_hu_600b31f4ce216cf3.png><meta property="og:title" content="SIEMForge"><meta property="og:type" content="website"><meta property="og:description" content="Portfolio and personal blog of Benny Temmerman, SIEMForge"><meta property="og:image" content="/images/site/background.jpg"><meta property="og:url" content="https://siemforge.xyz"><meta name=description content="Explaining logrotate configuration"><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "c845fbe0ec8f4fe1b3d3db62cc771051"}'></script><script integrity="sha256-DO4ugzEwhTW1Id1UIWn0gUJWaebCYOypeTit6LW4QB4=">let theme=localStorage.getItem("theme-scheme")||localStorage.getItem("darkmode:color-scheme")||"light";theme==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?theme="dark":theme="light"),document.documentElement.setAttribute("data-theme",theme)</script></head><body class="type-posts kind-page" data-bs-spy=scroll data-bs-target=#TableOfContents data-bs-offset=80><div class="container-fluid bg-secondary wrapper"><nav class="navbar navbar-expand-xl top-navbar shadow" id=top-navbar><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<i data-feather=sidebar></i>
</button>
<a class=navbar-brand href=/><img src=/images/site/main-logo_hu_600b31f4ce216cf3.png id=logo alt=Logo>
SIEMForge</a>
<button class="navbar-toggler navbar-light" id=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#top-nav-items aria-label=menu>
<i data-feather=menu></i></button><div class="collapse navbar-collapse dynamic-navbar" id=top-nav-items><ul class="nav navbar-nav ms-auto"><li class=nav-item><a class=nav-link href=/#home>Home</a></li><li class=nav-item><a class=nav-link href=/#about>About</a></li><li class=nav-item><a class=nav-link href=/#skills>Skills</a></li><li class=nav-item><a class=nav-link href=/#experiences>Experiences</a></li><li class=nav-item><a class=nav-link href=/#projects>Projects</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>More</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=/#featured-posts>Featured Posts</a>
<a class=dropdown-item href=/#accomplishments>Accomplishments</a></div></li><div id=top-navbar-divider></div><li class=nav-item><a class=nav-link id=blog-link href=/posts>Posts</a></li><li class=nav-item><a class=nav-link id=note-link href=/notes>Notes</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=theme-icon src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=theme-icon src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/main-logo_hu_600b31f4ce216cf3.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/inverted-logo_hu_600b31f4ce216cf3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><i data-feather=minus-circle></i><a class="active list-link" href=/posts/linux/> Linux</a><ul class=active><li><a class="active list-link" href=/posts/linux/logrotate/logrotatepost/ title=Logrotate>Logrotate</a></li><li><a class=list-link href=/posts/linux/lvm/lvmpost/ title=LVM>LVM</a></li><li><a class=list-link href=/posts/linux/tcpdump/tcpdumppost/ title=tcpdump>tcpdump</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/automation/> Automation</a><ul><li><a class=list-link href=/posts/automation/n8n/firstautomationworkflow/ title="My first automation workflow">My first automation workflow</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/siem/> SIEM</a><ul><li><a class=list-link href=/posts/siem/data-onboarding/dataonboardingpost/ title="SIEM data onboarding">SIEM data onboarding</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/images/posts/logrotate.jpg)></div><div class=page-content><div class="author-profile ms-auto align-self-lg-center"><img class=rounded-circle src=/images/author/john_hu_256e26af68e2f530.png alt="Author Image"><h5 class=author-name>Benny Temmerman</h5><p class=text-muted>Friday, June 6, 2025 | 4 minutes</p></div><div class=title><h1>Logrotate</h1></div><div class=tags><ul style=padding-left:0></ul></div><div class=post-content id=post-content><h1 id=mastering-logrotate-the-unsung-hero-of-log-management>Mastering Logrotate: The unsung hero of log management</h1><p>In the trenches of system administration, there&rsquo;s one silent guardian that keeps your disk space from imploding under a mountain of logs: <strong>Logrotate</strong>. Whether you&rsquo;re wrangling logs on a sprawling Kubernetes cluster or just babysitting a single Linux box, Logrotate ensures your logs don‚Äôt spiral out of control.</p><p>We‚Äôll explore how Logrotate works, why it‚Äôs essential, how to configure it like a pro, and how to troubleshoot when it throws a tantrum.</p><hr><h2 id=what-is-logrotate>What is Logrotate?</h2><p>At its core, <strong>Logrotate</strong> is a Unix utility designed to automatically rotate, compress, and remove log files. Think of it as your log janitor ‚Äî sweeping away old logs, zipping them up neatly, and ensuring your system never runs out of space due to runaway logging.</p><h3 id=why-it-matters>Why it matters:</h3><p>Imagine you‚Äôre running NGINX on a production server handling thousands of requests per second. Without log rotation, your access and error logs could balloon into gigabytes overnight. That‚Äôs a <strong>disk I/O nightmare</strong> waiting to happen.</p><hr><h2 id=logrotate-configuration-from-basics-to-battle-hardened>Logrotate configuration: From basics to battle-hardened</h2><p>Logrotate‚Äôs power lies in its flexibility. You can define global rules in <code>/etc/logrotate.conf</code>, or per-service rules in <code>/etc/logrotate.d/</code>.</p><h3 id=example-etclogrotatednginx>Example: <code>/etc/logrotate.d/nginx</code></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>/var/log/nginx/*.log <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    daily
</span></span><span style=display:flex><span>    rotate <span style=color:#ae81ff>14</span>
</span></span><span style=display:flex><span>    compress
</span></span><span style=display:flex><span>    delaycompress
</span></span><span style=display:flex><span>    missingok
</span></span><span style=display:flex><span>    notifempty
</span></span><span style=display:flex><span>    create <span style=color:#ae81ff>0640</span> www-data adm
</span></span><span style=display:flex><span>    sharedscripts
</span></span><span style=display:flex><span>    postrotate
</span></span><span style=display:flex><span>        systemctl reload nginx &gt; /dev/null 2&gt;&amp;<span style=color:#ae81ff>1</span> <span style=color:#f92672>||</span> true
</span></span><span style=display:flex><span>    endscript
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=what-each-directive-does>What each directive does:</h2><p><code>daily: </code>Rotate logs every day (alternatives: weekly, monthly, or custom intervals).<br><code>rotate 14: </code>Keep 14 archived logs before purging.<br><code>compress: </code>Gzip old logs to save space.<br><code>delaycompress: </code>Wait a cycle before compressing (avoids compressing still-used logs).<br><code>missingok: </code>Don‚Äôt freak out if a log file is missing.<br><code>notifempty: </code>Skip rotation for empty logs.<br><code>create 0640 www-data adm: </code>Create new logs with specific permissions.<br><code>sharedscripts: </code>Ensures postrotate only runs once per log group.<br><code>postrotate...endscript: </code>What to do after rotating logs ‚Äî in this case, gracefully reload NGINX.</p><blockquote><p>Pro Tip: Use copytruncate if your app won‚Äôt release the log file handle ‚Äî useful for apps that don&rsquo;t support log reopening on SIGHUP.</p></blockquote><h2 id=automating-with-cron>Automating with cron</h2><p>Logrotate is typically triggered by cron, so unless you&rsquo;re into manual rotations (why?), make sure this line exists in your cron jobs:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0</span> * * * /usr/sbin/logrotate /etc/logrotate.conf &gt;/dev/null 2&gt;&amp;<span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p>This runs it daily at midnight. You can customize it further with anacron or systemd timers if you&rsquo;re using newer systems like RHEL 8+ or Ubuntu 22.04+.</p><h2 id=common-pitfalls-and-how-to-debug-like-a-boss>Common pitfalls and how to debug like a boss</h2><p>Even a veteran sysadmin can get tripped up by Logrotate quirks. Here are some frequent headaches and their antidotes:</p><h3 id=problemfix>Problem fix</h3><p>üîÅ Log not rotating? Check if the cron job runs. Use logrotate -d for dry-run debugging.<br>üîí Permission denied? Ensure Logrotate has access (run as root or use sudo).<br>‚ùå Syntax error in config? Run logrotate -v /etc/logrotate.conf to see what it‚Äôs doing.<br>üíæ Disk still filling up? Reduce rotate count or increase compression aggressiveness.<br>üîÑ App not releasing log files? Use copytruncate or restart the service post-rotate.</p><h2 id=docker>Docker</h2><p>Running containers? Docker log files can balloon fast under /var/lib/docker/containers/. You can use logrotate or ‚Äî better ‚Äî configure Docker&rsquo;s own json-file driver like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;log-driver&#34;</span>: <span style=color:#e6db74>&#34;json-file&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;log-opts&#34;</span>: <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;max-size&#34;</span>: <span style=color:#e6db74>&#34;50m&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;max-file&#34;</span>: <span style=color:#e6db74>&#34;3&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>Boom ‚Äî Docker will auto-rotate logs per container.</p><h2 id=final-thoughts>Final thoughts</h2><p>Logrotate might not be flashy, but it‚Äôs a critical piece of your system&rsquo;s hygiene. Treat it like a core dependency ‚Äî because it is. With smart configurations, regular checks, and a few advanced tweaks, you can keep your logs lean, searchable, and under control.</p><blockquote><p>Whether you&rsquo;re taming Apache logs, managing containerized chaos, or just keeping your home lab in shape, Logrotate will be your quiet, powerful ally.</p></blockquote><h2 id=tldr-cheat-sheet>TL;DR cheat sheet</h2><ul><li><p>Config files: /etc/logrotate.conf, /etc/logrotate.d/*</p></li><li><p>Common flags: daily, rotate, compress, create, copytruncate</p></li><li><p>Debug command: logrotate -d /etc/logrotate.conf</p></li><li><p>Test manually: logrotate -f /etc/logrotate.conf</p></li><li><p>Keep it cron‚Äôd: crontab -e</p></li></ul><blockquote><p>A more extensive cheatsheet can be found here: <a href=/notes/linux/logrotate>Logrotate cheatsheet</a></p></blockquote><p>Now go forth and rotate like a boss. üåÄ</p></div><div class="row ps-3 pe-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn icon-button bg-facebook" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fsiemforge.xyz%2fposts%2flinux%2flogrotate%2flogrotatepost%2f" target=_blank><i class="fab fa-facebook"></i>
</a><a class="btn icon-button bg-reddit" href="https://reddit.com/submit?url=https%3a%2f%2fsiemforge.xyz%2fposts%2flinux%2flogrotate%2flogrotatepost%2f&title=Logrotate" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn icon-button bg-linkedin" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fsiemforge.xyz%2fposts%2flinux%2flogrotate%2flogrotatepost%2f&title=Logrotate" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn icon-button bg-whatsapp" href="https://api.whatsapp.com/send?text=Logrotate https%3a%2f%2fsiemforge.xyz%2fposts%2flinux%2flogrotate%2flogrotatepost%2f" target=_blank><i class="fab fa-whatsapp"></i>
</a><a class="btn icon-button" href="mailto:?subject=Logrotate&body=https%3a%2f%2fsiemforge.xyz%2fposts%2flinux%2flogrotate%2flogrotatepost%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/bennytemmerman/toha/edit/main/content/posts/Linux/Logrotate/logrotatePost.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-12 next-article"><a href=/posts/linux/lvm/lvmpost/ title=LVM class="btn filled-button"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>LVM</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn type=button data-bs-toggle=tooltip data-bs-placement=left title="Scroll to top"><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center ps-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#what-is-logrotate>What is Logrotate?</a><ul><li><a href=#why-it-matters>Why it matters:</a></li></ul></li><li><a href=#logrotate-configuration-from-basics-to-battle-hardened>Logrotate configuration: From basics to battle-hardened</a><ul><li><a href=#example-etclogrotatednginx>Example: <code>/etc/logrotate.d/nginx</code></a></li></ul></li><li><a href=#what-each-directive-does>What each directive does:</a></li><li><a href=#automating-with-cron>Automating with cron</a></li><li><a href=#common-pitfalls-and-how-to-debug-like-a-boss>Common pitfalls and how to debug like a boss</a><ul><li><a href=#problemfix>Problem fix</a></li></ul></li><li><a href=#docker>Docker</a></li><li><a href=#final-thoughts>Final thoughts</a></li><li><a href=#tldr-cheat-sheet>TL;DR cheat sheet</a></li></ul></nav></div></div></section></div><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "c845fbe0ec8f4fe1b3d3db62cc771051"}'></script><script src=https://storage.ko-fi.com/cdn/scripts/overlay-widget.js></script><script>kofiWidgetOverlay.draw("siemforge",{type:"floating-chat","floating-chat.donateButton.text":"Support me","floating-chat.donateButton.background-color":"#00b9fe","floating-chat.donateButton.text-color":"#fff"})</script><script src=/application.fda7b48a8d3c362b0b790a3314272696a7a899a2e1ea88f0bfb6823f2191c23c.js integrity="sha256-/ae0io08NisLeQozFCcmlqeomaLh6ojwv7aCPyGRwjw=" defer></script></body></html>