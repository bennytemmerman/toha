<!doctype html><html lang=en><head><title>TCPDump</title><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.357dd1de946e0748ed1ed88009a6203f270bccbdabe5793ab4aab15964be163a.css integrity="sha256-NX3R3pRuB0jtHtiACaYgPycLzL2r5Xk6tKqxWWS+Fjo="><link rel=icon type=image/png href=/images/site/favicon_hu_c11ce0d32209d128.png><meta property="og:title" content="SIEMForge"><meta property="og:type" content="website"><meta property="og:description" content="Portfolio and personal blog of Benny Temmerman, SIEMForge"><meta property="og:image" content="/images/site/background.jpg"><meta property="og:url" content="https://siemforge.xyz"><meta name=description content="TCPDump usage"><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "c845fbe0ec8f4fe1b3d3db62cc771051"}'></script><script integrity="sha256-DO4ugzEwhTW1Id1UIWn0gUJWaebCYOypeTit6LW4QB4=">let theme=localStorage.getItem("theme-scheme")||localStorage.getItem("darkmode:color-scheme")||"light";theme==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?theme="dark":theme="light"),document.documentElement.setAttribute("data-theme",theme)</script></head><body class="type-posts kind-page" data-bs-spy=scroll data-bs-target=#TableOfContents data-bs-offset=80><div class="container-fluid bg-secondary wrapper"><nav class="navbar navbar-expand-xl top-navbar shadow" id=top-navbar><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<i data-feather=sidebar></i>
</button>
<a class=navbar-brand href=/><img src=/images/site/main-logo_hu_c11ce0d32209d128.png id=logo alt=Logo>
SIEMForge</a>
<button class="navbar-toggler navbar-light" id=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#top-nav-items aria-label=menu>
<i data-feather=menu></i></button><div class="collapse navbar-collapse dynamic-navbar" id=top-nav-items><ul class="nav navbar-nav ms-auto"><li class=nav-item><a class=nav-link href=/#home>Home</a></li><li class=nav-item><a class=nav-link href=/#about>About</a></li><li class=nav-item><a class=nav-link href=/#skills>Skills</a></li><li class=nav-item><a class=nav-link href=/#experiences>Experiences</a></li><li class=nav-item><a class=nav-link href=/#projects>Projects</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>More</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=/#featured-posts>Featured Posts</a>
<a class=dropdown-item href=/#accomplishments>Accomplishments</a></div></li><div id=top-navbar-divider></div><li class=nav-item><a class=nav-link id=blog-link href=/posts>Posts</a></li><li class=nav-item><a class=nav-link id=note-link href=/notes>Notes</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=theme-icon src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=theme-icon src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/main-logo_hu_c11ce0d32209d128.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/inverted-logo_hu_c11ce0d32209d128.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><i data-feather=minus-circle></i><a class="active list-link" href=/posts/linux/> Linux</a><ul class=active><li><a class=list-link href=/posts/linux/logrotate/logrotatepost/ title=Logrotate>Logrotate</a></li><li><a class=list-link href=/posts/linux/lvm/lvmpost/ title=LVM>LVM</a></li><li><a class="active list-link" href=/posts/linux/tcpdump/tcpdumppost/ title=tcpdump>tcpdump</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/automation/> Automation</a><ul><li><a class=list-link href=/posts/automation/n8n/firstautomationworkflow/ title="My first automation workflow">My first automation workflow</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/images/posts/tcpdump.png)></div><div class=page-content><div class="author-profile ms-auto align-self-lg-center"><img class=rounded-circle src=/images/author/john_hu_ac4e952638c97582.png alt="Author Image"><h5 class=author-name>Benny Temmerman</h5><p class=text-muted>Tuesday, June 24, 2025 | 2 minutes</p></div><div class=title><h1>TCPDump</h1></div><div class=tags><ul style=padding-left:0></ul></div><div class=post-content id=post-content><h1 id=tcpdump-deepdive-for-linux-engineers>TCPDump deepdive for Linux engineers</h1><p>As a SIEM platform administrator, one of the most invaluable tools in my troubleshooting arsenal is tcpdump. It allows the user to display TCP/IP and other packets being transmitted or received over a network. Despite its simplicity, it is incredibly powerful for debugging complex network issues, monitoring traffic, or simply learning how different protocols behave.</p><h2 id=why-use-tcpdump>Why use tcpdump</h2><ul><li>Real-time packet inspection</li><li>Lightweight and scriptable</li><li>No need for a GUI</li><li>Useful for security auditing and troubleshooting</li></ul><h2 id=how-to-install-tcpdump>How to install tcpdump</h2><p>On Debian/Ubuntu-based systems:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update <span style=color:#f92672>&amp;&amp;</span> sudo apt install tcpdump
</span></span></code></pre></div><p>On RHEL/CentOS (YUM-based systems):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo yum install tcpdump
</span></span></code></pre></div><p>On Fedora/DNF-based systems:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo dnf install tcpdump
</span></span></code></pre></div><p>From Source:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install libpcap-dev gcc make -y
</span></span><span style=display:flex><span>wget http://www.tcpdump.org/release/tcpdump-4.99.4.tar.gz
</span></span><span style=display:flex><span>tar -xvzf tcpdump-4.99.4.tar.gz
</span></span><span style=display:flex><span>cd tcpdump-4.99.4
</span></span><span style=display:flex><span>./configure
</span></span><span style=display:flex><span>make
</span></span><span style=display:flex><span>sudo make install
</span></span></code></pre></div><h2 id=basic-usage-examples>Basic usage examples</h2><p>Capture traffic on eth0</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tcpdump -i eth0
</span></span></code></pre></div><p>Capture only TCP packets</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tcpdump -i eth0 tcp
</span></span></code></pre></div><p>Capture packets from a specific host</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tcpdump -i eth0 host 192.168.1.100
</span></span></code></pre></div><p>Save captured data to a file</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tcpdump -i eth0 -w capture.pcap
</span></span></code></pre></div><p>Read from a saved capture file</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tcpdump -r capture.pcap
</span></span></code></pre></div><p>Limit the number of packets</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tcpdump -i eth0 -c <span style=color:#ae81ff>100</span>
</span></span></code></pre></div><p>Filter by port</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tcpdump -i eth0 port <span style=color:#ae81ff>443</span>
</span></span></code></pre></div><p>Verbose output with hex</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tcpdump -XX -i eth0
</span></span></code></pre></div><p>Display packet timestamp in readable format</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tcpdump -tttt -i eth0
</span></span></code></pre></div><p>Real-World Example: Debugging HTTP Requests</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tcpdump -i eth0 -nn -s <span style=color:#ae81ff>0</span> -v tcp port <span style=color:#ae81ff>80</span>
</span></span></code></pre></div><p>This captures HTTP requests in verbose mode, disables hostname and port name resolution, and captures the entire packet.</p><h2 id=security-consideration>Security consideration</h2><p>You need elevated privileges to run tcpdump. Consider creating a dedicated group or using capabilities:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo setcap cap_net_raw,cap_net_admin<span style=color:#f92672>=</span>eip <span style=color:#66d9ef>$(</span>which tcpdump<span style=color:#66d9ef>)</span>
</span></span></code></pre></div><h2 id=important-notice>Important notice!</h2><p>During troubleshooting, I encountered an issue on two occasions where no logs were received. Further investigation with tcpdump revealed insights into the packets that were received. When comparing incoming data, it was observed that the data had a length greater than zero, whereas the other log source only showed packets of length zero. After restarting the syslog service on the host that stopped sending data, new data was successfully ingested into our SIEM.</p><p><img src=/images/posts/ex_tcpdump.png alt="Example TCPDump output"></p><blockquote><p>Please note that a packet length of zero can indicate two possibilities: the data might be encrypted, or, as in the example provided, the packets could be used to maintain the connection (keep-alive packets).</p></blockquote><h2 id=conclusion>Conclusion</h2><p>Whether you&rsquo;re a network administrator, security professional, or developer, tcpdump is a skill worth mastering. Its ability to dissect network traffic at the most granular level makes it indispensable in any Linux environment.</p><h2 id=cheatsheet>Cheatsheet</h2><blockquote><p>A more extensive cheatsheet can be found here: <a href=/notes/linux/tcpdump/tcpdump_cheatsheet/>TCPDump cheatsheet</a></p></blockquote></div><div class="row ps-3 pe-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn icon-button bg-facebook" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fsiemforge.xyz%2fposts%2flinux%2ftcpdump%2ftcpdumppost%2f" target=_blank><i class="fab fa-facebook"></i>
</a><a class="btn icon-button bg-reddit" href="https://reddit.com/submit?url=https%3a%2f%2fsiemforge.xyz%2fposts%2flinux%2ftcpdump%2ftcpdumppost%2f&title=TCPDump" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn icon-button bg-linkedin" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fsiemforge.xyz%2fposts%2flinux%2ftcpdump%2ftcpdumppost%2f&title=TCPDump" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn icon-button bg-whatsapp" href="https://api.whatsapp.com/send?text=TCPDump https%3a%2f%2fsiemforge.xyz%2fposts%2flinux%2ftcpdump%2ftcpdumppost%2f" target=_blank><i class="fab fa-whatsapp"></i>
</a><a class="btn icon-button" href="mailto:?subject=TCPDump&body=https%3a%2f%2fsiemforge.xyz%2fposts%2flinux%2ftcpdump%2ftcpdumppost%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/bennytemmerman/toha/edit/main/content/posts/Linux/tcpdump/tcpdumpPost.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/linux/lvm/lvmpost/ title=LVM class="btn filled-button"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>LVM</div></a></div><div class="col-md-6 next-article"><a href=/posts/automation/n8n/firstautomationworkflow/ title="My first automation workflow" class="btn filled-button"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>My first automation workflow</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn type=button data-bs-toggle=tooltip data-bs-placement=left title="Scroll to top"><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center ps-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#why-use-tcpdump>Why use tcpdump</a></li><li><a href=#how-to-install-tcpdump>How to install tcpdump</a></li><li><a href=#basic-usage-examples>Basic usage examples</a></li><li><a href=#security-consideration>Security consideration</a></li><li><a href=#important-notice>Important notice!</a></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#cheatsheet>Cheatsheet</a></li></ul></nav></div></div></section></div><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "c845fbe0ec8f4fe1b3d3db62cc771051"}'></script><script src=/application.930be624d64a67aaa78804547cad0511dccdd26cda012034047bff3f69582ac9.js integrity="sha256-kwvmJNZKZ6qniARUfK0FEdzN0mzaASA0BHv/P2lYKsk=" defer></script></body></html>