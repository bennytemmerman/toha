<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>SIEMForge</title><link>https://siemforge.xyz/</link><description>Recent content on SIEMForge</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Tue, 08 Jun 2010 08:06:25 +0600</lastBuildDate><atom:link href="https://siemforge.xyz/index.xml" rel="self" type="application/rss+xml"/><item><title>Linux Bash commands</title><link>https://siemforge.xyz/notes/linux/cli/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://siemforge.xyz/notes/linux/cli/</guid><description>&lt;div style="display: block; width: 100%; max-width: none;">
&lt;!-- Troubleshooting: -->
&lt;div class="note-card ">
&lt;div class="item">
&lt;h5 class="note-title">&lt;span>Troubleshooting (files):&lt;/span>&lt;/h5>
&lt;div class="card">
&lt;div class="card-body">&lt;p>Find a file or directory&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>find / -type f -name &lt;span style="color:#e6db74">&amp;#34;filename&amp;#34;&lt;/span> 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>find / -type d -name &lt;span style="color:#e6db74">&amp;#34;dirname&amp;#34;&lt;/span> 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>find files that contain a pattern&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>find . -type f -exec grep -l &lt;span style="color:#e6db74">&amp;#39;version&amp;#39;&lt;/span> &lt;span style="color:#f92672">{}&lt;/span> &lt;span style="color:#ae81ff">\;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;!-- Troubleshooting: -->
&lt;div class="note-card ">
&lt;div class="item">
&lt;h5 class="note-title">&lt;span>Troubleshooting (system):&lt;/span>&lt;/h5>
&lt;div class="card">
&lt;div class="card-body">&lt;p>Find a file or directory&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>find / -type f -name &lt;span style="color:#e6db74">&amp;#34;filename&amp;#34;&lt;/span> 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>find / -type d -name &lt;span style="color:#e6db74">&amp;#34;dirname&amp;#34;&lt;/span> 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>check if machine is a vm or barebone&lt;/p></description></item><item><title>Splunk searches</title><link>https://siemforge.xyz/notes/splunk/spl/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://siemforge.xyz/notes/splunk/spl/</guid><description>&lt;div style="display: block; width: 100%; max-width: none;">
&lt;!-- Troubleshooting: -->
&lt;div class="note-card ">
&lt;div class="item">
&lt;h5 class="note-title">&lt;span>Troubleshooting:&lt;/span>&lt;/h5>
&lt;div class="card">
&lt;div class="card-body">&lt;p>Errorcheck within Splunk GUI&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>index&lt;span style="color:#f92672">=&lt;/span>_internal log_level&lt;span style="color:#f92672">=&lt;/span>ERROR source&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;/opt/splunk/var/log/splunk/splunkd.log&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Check Splunk version&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>| rest splunk_server&lt;span style="color:#f92672">=&lt;/span>* count&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span> /services/server/info
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| table version host
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;!-- Index -->
&lt;div class="note-card ">
&lt;div class="item">
&lt;h5 class="note-title">&lt;span>Index&lt;/span>&lt;/h5>
&lt;div class="card">
&lt;div class="card-body">&lt;p>List indexes with the retention period&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>| rest splunk_server&lt;span style="color:#f92672">=&lt;/span>* /services/data/indexes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| eval &lt;span style="color:#e6db74">&amp;#34;Retention Period (months)&amp;#34;&lt;/span>&lt;span style="color:#f92672">=&lt;/span>round&lt;span style="color:#f92672">((&lt;/span>frozenTimePeriodInSecs/2628000&lt;span style="color:#f92672">)&lt;/span>,0&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| search NOT title IN &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#e6db74">&amp;#34;_*&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;main&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;history&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;summary&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;splunklogger&amp;#34;&lt;/span>&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| table title &lt;span style="color:#e6db74">&amp;#34;Retention Period (months)&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| rename title as Index
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">```&lt;/span>&lt;span style="color:#66d9ef">for&lt;/span> years, divide frozenTimePeriodInSecs/31556952; &lt;span style="color:#66d9ef">for&lt;/span> days, divide frozenTimePeriodInSecs/86400&lt;span style="color:#e6db74">```&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;!-- Hosts -->
&lt;div class="note-card ">
&lt;div class="item">
&lt;h5 class="note-title">&lt;span>Hosts&lt;/span>&lt;/h5>
&lt;div class="card">
&lt;div class="card-body">&lt;p>Overview of hosts sending logs by index&lt;/p></description></item><item><title>Logrotate config</title><link>https://siemforge.xyz/notes/linux/logrotate/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://siemforge.xyz/notes/linux/logrotate/</guid><description>&lt;div style="display: block; width: 100%; max-width: none;">
&lt;!-- Troubleshooting: -->
&lt;div class="note-card ">
&lt;div class="item">
&lt;h5 class="note-title">&lt;span>Logrotate Configuration Cheat Sheet:&lt;/span>&lt;/h5>
&lt;div class="card">
&lt;div class="card-body">This cheat sheet provides an extensive list of Logrotate configuration directives, their descriptions, and examples.
Use this as a quick reference to master log rotation on Unix-like systems.&lt;/div>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;div class="note-card ">
&lt;div class="item">
&lt;h5 class="note-title">&lt;span>Basic structure&lt;/span>&lt;/h5>
&lt;div class="card">
&lt;div class="card-body">&lt;p>Each configuration block is tied to a log file or set of log files. Example:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>/var/log/example.log &lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> daily
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> rotate &lt;span style="color:#ae81ff">7&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> compress
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> missingok
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> notifempty
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> create &lt;span style="color:#ae81ff">0640&lt;/span> root adm
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>&lt;div class="note-card ">
&lt;div class="item">
&lt;h5 class="note-title">&lt;span>Configuration Directives &amp;amp; Examples&lt;/span>&lt;/h5>
&lt;div class="card">
&lt;div class="card-body">&lt;h4 id="basic-settings">Basic Settings:&lt;/h4>
&lt;pre>&lt;code>- rotate &amp;lt;count&amp;gt;
Keep &amp;lt;count&amp;gt; number of old log files before deleting them.
- daily | weekly | monthly | yearly
Frequency of rotation.
&lt;/code>&lt;/pre>
&lt;h4 id="compression-options">Compression Options:&lt;/h4>
&lt;pre>&lt;code>compress
Compress old versions of log files with gzip.
nocompress
Do not compress old logs.
delaycompress
Postpone compression to the next rotation cycle (used with compress).
&lt;/code>&lt;/pre>
&lt;h4 id="file-handling">File Handling:&lt;/h4>
&lt;pre>&lt;code>missingok
Ignore missing log files and don’t issue an error.
notifempty
Do not rotate the log if it is empty.
ifempty
Rotate the log even if it is empty (default behavior).
create &amp;lt;mode&amp;gt; &amp;lt;owner&amp;gt; &amp;lt;group&amp;gt;
Create a new log file with specified permissions.
copy
Make a copy of the log file and truncate the original.
copytruncate
Truncate the original log file after copying it (useful for active logs).
&lt;/code>&lt;/pre>
&lt;h4 id="date--naming">Date &amp;amp; Naming:&lt;/h4>
&lt;pre>&lt;code>dateext
Append an extension with the current date to rotated log files.
dateformat .%Y-%m-%d
Custom format for dateext (e.g., .2025-06-06).
extension &amp;lt;ext&amp;gt;
Force specific extension for rotated files (e.g., .log).
&lt;/code>&lt;/pre>
&lt;h4 id="size-based-rotation">Size-Based Rotation:&lt;/h4>
&lt;pre>&lt;code>maxage &amp;lt;days&amp;gt;
Remove rotated logs older than &amp;lt;days&amp;gt;.
minsize &amp;lt;size&amp;gt;
Rotate only if log size is above &amp;lt;size&amp;gt;.
size &amp;lt;size&amp;gt;
Rotate if log file size meets threshold, regardless of time.
maxsize &amp;lt;size&amp;gt;
Do not rotate if log is larger than specified size.
&lt;/code>&lt;/pre>
&lt;h4 id="directory--scripts">Directory &amp;amp; Scripts:&lt;/h4>
&lt;pre>&lt;code>olddir &amp;lt;dir&amp;gt;
Move rotated logs to a specified directory.
sharedscripts
Run postrotate script once for all matching logs.
postrotate/endscript
Script to run after log rotation.
prerotate/endscript
Script to run before log rotation.
firstaction/endscript
Run only once before rotation begins (before prerotate).
lastaction/endscript
Run once after rotation finishes (after postrotate).
tabooext + &amp;lt;ext&amp;gt;
Treat additional extensions as taboo (not rotated).
&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;div class="note-card ">
&lt;div class="item">
&lt;h5 class="note-title">&lt;span>Full Example Configuration&lt;/span>&lt;/h5>
&lt;div class="card">
&lt;div class="card-body">&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>/var/log/myapp/*.log &lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> daily
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> rotate &lt;span style="color:#ae81ff">10&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> size 100M
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> compress
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> delaycompress
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> missingok
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> notifempty
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> create &lt;span style="color:#ae81ff">0640&lt;/span> appuser adm
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> sharedscripts
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> postrotate
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> systemctl reload myapp &amp;gt; /dev/null 2&amp;gt;&amp;amp;&lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#f92672">||&lt;/span> true
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> endscript
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;div class="note-card ">
&lt;div class="item">
&lt;h5 class="note-title">&lt;span>Tips&lt;/span>&lt;/h5>
&lt;div class="card">
&lt;div class="card-body">• Run &lt;code>logrotate -d &amp;lt;config&amp;gt;&lt;/code> to debug your config without applying changes.
• Use &lt;code>logrotate -f &amp;lt;config&amp;gt;&lt;/code> to force rotation for testing.
• Logrotate is typically triggered via cron or systemd timers.
• Keep your config DRY by centralizing shared logic in /etc/logrotate.conf and using includes.&lt;/div>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;/p></description></item><item><title>Splunk CLI commands</title><link>https://siemforge.xyz/notes/splunk/cli/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://siemforge.xyz/notes/splunk/cli/</guid><description>&lt;div style="display: block; width: 100%; max-width: none;">
&lt;!-- Maintenance: -->
&lt;div class="note-card ">
&lt;div class="item">
&lt;h5 class="note-title">&lt;span>Maintenance:&lt;/span>&lt;/h5>
&lt;div class="card">
&lt;div class="card-body">&lt;p>Start Splunk&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>/opt/splunk/bin/splunk start
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Stop Splunk&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>/opt/splunk/bin/splunk stop
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Restart Splunk&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>/opt/splunk/bin/splunk restart
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Check if Splunk is running&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>/opt/splunk/bin/splunk status
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Reload a serverclass to push deployment apps without restarting Splunk&amp;quot;&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>/opt/splunk/bin/splunk reload deploy-server -class &lt;span style="color:#f92672">[&lt;/span>serverclass-name&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Check license expiration date&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>/opt/splunk/bin/splunk list licenses | grep &lt;span style="color:#e6db74">&amp;#34;expiration_time&amp;#34;&lt;/span> | awk -F&lt;span style="color:#e6db74">&amp;#39;:&amp;#39;&lt;/span> &lt;span style="color:#e6db74">&amp;#39;{print $2}&amp;#39;&lt;/span> | xargs -I&lt;span style="color:#f92672">{}&lt;/span> date -d @&lt;span style="color:#f92672">{}&lt;/span> +&lt;span style="color:#e6db74">&amp;#34;%Y-%m-%d %H:%M:%S&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>List installed apps and their status&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>/opt/splunk/bin/splunk list app
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>List installed apps and their version (if found)&lt;/p></description></item><item><title>Splunk Upgrade procedure</title><link>https://siemforge.xyz/notes/splunk/splunk-upgrade/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://siemforge.xyz/notes/splunk/splunk-upgrade/</guid><description>&lt;div style="display: block; width: 100%; max-width: none;">
&lt;!-- Upgrade procedure: -->
&lt;div class="note-card ">
&lt;div class="item">
&lt;h5 class="note-title">&lt;span>Upgrade procedure:&lt;/span>&lt;/h5>
&lt;div class="card">
&lt;div class="card-body">&lt;h1 id="splunk-upgrade-guide">Splunk Upgrade Guide&lt;/h1>
&lt;p>This document provides a step-by-step procedure to upgrade Splunk from an existing version to a newer release. Follow each section carefully to ensure a smooth upgrade process.&lt;/p>
&lt;h2 id="table-of-contents">Table of Contents&lt;/h2>
&lt;ol>
&lt;li>Preparation&lt;/li>
&lt;li>Download and Transfer Files&lt;/li>
&lt;li>Pre-Upgrade Checks&lt;/li>
&lt;li>Device State Management&lt;/li>
&lt;li>Backup Current Configuration&lt;/li>
&lt;li>Install the New Version&lt;/li>
&lt;li>Post-Upgrade Verification&lt;/li>
&lt;li>Documentation and Communication&lt;/li>
&lt;/ol>
&lt;h2 id="1-preparation">1. Preparation&lt;/h2>
&lt;ul>
&lt;li>Ensure you have access to the target devices and necessary permissions.&lt;/li>
&lt;li>Confirm the current Splunk version.&lt;/li>
&lt;li>Notify customer and colleagues about the upcoming upgrade.&lt;/li>
&lt;li>Review release notes for the target version.&lt;/li>
&lt;/ul>
&lt;h2 id="2-download-and-transfer-files">2. Download and Transfer Files&lt;/h2>
&lt;h3 id="download-the-splunk-installer">Download the Splunk Installer&lt;/h3>
&lt;p>You can use the wget command to download the package on the host
wget -O splunk-&lt;version>-&lt;hash>-Linux-x86_64.tgz &amp;ldquo;&lt;a href="https://download.splunk.com/products/splunk/releases/" target="_blank" rel="noopener">https://download.splunk.com/products/splunk/releases/&lt;/a>&lt;version>/linux/splunk-&lt;version>-&lt;hash>-Linux-x86_64.tgz&amp;rdquo;&lt;/p></description></item></channel></rss>