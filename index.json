[{"categories":null,"contents":" Troubleshooting: Errorcheck within Splunk GUI\nindex=_internal log_level=ERROR source=\u0026#34;/opt/splunk/var/log/splunk/splunkd.log\u0026#34; Check Splunk version\n| rest splunk_server=* count=1 /services/server/info | table version host Index List indexes with the retention period\n| rest splunk_server=* /services/data/indexes | eval \u0026#34;Retention Period (months)\u0026#34;=round((frozenTimePeriodInSecs/2628000),0) | search NOT title IN (\u0026#34;_*\u0026#34;, \u0026#34;main\u0026#34;, \u0026#34;history\u0026#34;, \u0026#34;summary\u0026#34;, \u0026#34;splunklogger\u0026#34;) | table title \u0026#34;Retention Period (months)\u0026#34; | rename title as Index ```for years, divide frozenTimePeriodInSecs/31556952; for days, divide frozenTimePeriodInSecs/86400``` Hosts Overview of hosts sending logs by index\n| tstats values(host) where index=* by index License Usage per day by index + percentages\nindex=_internal source=*license_usage.log type=\u0026#34;Usage\u0026#34; | bin _time span=1d | stats sum(b) as b by idx, _time | eval GB=round((b/31556952),2) | eventstats sum(GB) as total_GB by _time | eval percentage=round((GB/total_GB)*100,2) | sort -_time -GB | fields - b, total_GB | rename idx as Index, GB as \u0026#34;Size (GB)\u0026#34;, percentage as \u0026#34;Percentage (%)\u0026#34; | convert timeformat=\u0026#34;%Y-%m-%d\u0026#34; ctime(_time) as Date | fields Date, Index, \u0026#34;Size (GB)\u0026#34;, \u0026#34;Percentage (%)\u0026#34; ```for years, divide b/31556952; for days, divide b/31556952``` Users List users and their roles\n| rest /services/authentication/users splunk_server=local | fields title roles email | rename title as username ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://siemforge.xyz/notes/splunk/spl/","summary":"\u003cdiv style=\"display: block; width: 100%; max-width: none;\"\u003e\n\u003c!-- Troubleshooting:  --\u003e\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eTroubleshooting:\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cp\u003eErrorcheck within Splunk GUI\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eindex\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e_internal log_level\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eERROR source\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/opt/splunk/var/log/splunk/splunkd.log\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eCheck Splunk version\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| rest splunk_server\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e* count\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e /services/server/info \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| table version host\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003c!-- Index --\u003e\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eIndex\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cp\u003eList indexes with the retention period\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| rest splunk_server\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e* /services/data/indexes \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| eval \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Retention Period (months)\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eround\u003cspan style=\"color:#f92672\"\u003e((\u003c/span\u003efrozenTimePeriodInSecs/2628000\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e,0\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| search NOT title IN \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;_*\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;main\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;history\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;summary\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;splunklogger\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| table title \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Retention Period (months)\u0026#34;\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| rename title as Index\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e```\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e years, divide frozenTimePeriodInSecs/31556952; \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e days, divide frozenTimePeriodInSecs/86400\u003cspan style=\"color:#e6db74\"\u003e```\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003c!-- Hosts --\u003e\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eHosts\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cp\u003eOverview of hosts sending logs by index\u003c/p\u003e","tags":null,"title":"Splunk searches"},{"categories":null,"contents":" Maintenance: Start Splunk\n/opt/splunk/bin/splunk start Stop Splunk\n/opt/splunk/bin/splunk stop Restart Splunk\n/opt/splunk/bin/splunk restart Check if Splunk is running\n/opt/splunk/bin/splunk status Reload a serverclass to push deployment apps without restarting Splunk\u0026quot;\n/opt/splunk/bin/splunk reload deploy-server -class [serverclass-name] Check license expiration date\n/opt/splunk/bin/splunk list licenses | grep \u0026#34;expiration_time\u0026#34; | awk -F\u0026#39;:\u0026#39; \u0026#39;{print $2}\u0026#39; | xargs -I{} date -d @{} +\u0026#34;%Y-%m-%d %H:%M:%S\u0026#34; List installed apps and their status\n/opt/splunk/bin/splunk list app List installed apps and their version (if found)\n/opt/splunk/bin/splunk list app | grep version /opt/splunk/etc/apps/*/default/app.conf Install an app\n/splunk install app \u0026lt;path to app.package\u0026gt; Update an app\n/splunk install app \u0026lt;path to app.package\u0026gt; -update 1 Remove an app\n/opt/splunk/bin/splunk remove app [appname] Check Splunk admins\n/opt/splunk/bin/splunk list user | grep admin -B2 Basic config: Enable Splunk service to start when the host boots up\n/opt/splunk/bin/splunk enable Disable Splunk service so it doesn\u0026rsquo;t start when the host boots up\n/opt/splunk/bin/splunk disable Extra: Find the startup message\ncat /opt/splunk/var/log/splunk/splunkd_stdout.log | grep \u0026#34;Splunk\u0026gt;\u0026#34; | tail -n 1 ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://siemforge.xyz/notes/splunk/cli/","summary":"\u003cdiv style=\"display: block; width: 100%; max-width: none;\"\u003e\n\u003c!-- Maintenance: --\u003e\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eMaintenance:\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cp\u003eStart Splunk\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/opt/splunk/bin/splunk start\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eStop Splunk\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/opt/splunk/bin/splunk stop\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eRestart Splunk\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/opt/splunk/bin/splunk restart\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eCheck if Splunk is running\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/opt/splunk/bin/splunk status\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eReload a serverclass to push deployment apps without restarting Splunk\u0026quot;\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/opt/splunk/bin/splunk reload deploy-server -class \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eserverclass-name\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eCheck license expiration date\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/opt/splunk/bin/splunk list licenses | grep \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;expiration_time\u0026#34;\u003c/span\u003e | awk -F\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;:\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print $2}\u0026#39;\u003c/span\u003e | xargs -I\u003cspan style=\"color:#f92672\"\u003e{}\u003c/span\u003e date -d @\u003cspan style=\"color:#f92672\"\u003e{}\u003c/span\u003e +\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%Y-%m-%d %H:%M:%S\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eList installed apps and their status\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/opt/splunk/bin/splunk list app\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eList installed apps and their version (if found)\u003c/p\u003e","tags":null,"title":"Splunk CLI commands"},{"categories":null,"contents":" Upgrade procedure: Splunk Upgrade Guide This document provides a step-by-step procedure to upgrade Splunk from an existing version to a newer release. Follow each section carefully to ensure a smooth upgrade process.\nTable of Contents Preparation Download and Transfer Files Pre-Upgrade Checks Device State Management Backup Current Configuration Install the New Version Post-Upgrade Verification Documentation and Communication 1. Preparation Ensure you have access to the target devices and necessary permissions. Confirm the current Splunk version. Notify customer and colleagues about the upcoming upgrade. Review release notes for the target version. 2. Download and Transfer Files Download the Splunk Installer You can use the wget command to download the package on the host wget -O splunk---Linux-x86_64.tgz \u0026ldquo;https://download.splunk.com/products/splunk/releases//linux/splunk---Linux-x86_64.tgz\u0026rdquo;\nsudo -i cd /tmp wget -O splunk-9.4.3-237ebbd22314-linux-amd64.tgz \u0026#34;https://download.splunk.com/products/splunk/releases/9.4.3/linux/splunk-9.4.3-237ebbd22314-linux-amd64.tgz\u0026#34; Transfer the Installer to Target Devices Use WinSCP or similar tools to connect and send to the device: put \u0026ldquo;path\\to\\splunk---Linux-x86_64.tgz\u0026rdquo; \u0026ldquo;/tmp/splunk---Linux-x86_64.tgz\u0026rdquo;\nset path=C:\\Program Files (x86)\\WinSCP;%path% winscp sftp://\u0026lt;CLI-account\u0026gt;@\u0026lt;device_NAT_IP\u0026gt;:/tmp put \u0026#34;path\\to\\splunk-9.4.3-237ebbd22314-linux-amd64.tgz\u0026#34; \u0026#34;/tmp/splunk-9.4.3-237ebbd22314-linux-amd64.tgz\u0026#34; Use SCP on more recent windows machines or on Linux:\nscp \u0026#34;path\\to\\splunk-9.4.3-237ebbd22314-linux-amd64.tgz\u0026#34; user@remote-ip:\u0026#34;/tmp/splunk-9.4.3-237ebbd22314-linux-amd64.tgz\u0026#34; 3. Pre-Upgrade Checks Check if Splunk has an active process:\nps -ef | grep splunk Check if Splunk is running:\n/opt/splunk/bin/splunk status Check Splunk version:\n/opt/splunk/bin/splunk --version 4. Device State Management Check whether a monitoring needs to set the host in maintenance mode\nOn Splunk in environments with index clusters: Maintenance mode halts most bucket fixup activity and prevents frequent rolling of hot buckets. It is useful when performing peer upgrades and other maintenance activities on an indexer cluster. Enable maintenance mode:\n/opt/splunk/bin/splunk enable maintenance-mode Disable maintenance mode:\n/opt/splunk/bin/splunk disable maintenance-mode Enable maintenance mode:\n/opt/splunk/bin/splunk show maintenance-mode 5. Backup Current Configuration Check KV Store status\n/opt/splunk/bin/splunk show kvstore-status Backup KV Store\n/opt/splunk/bin/splunk backup kvstore Check backup\nls -la /opt/splunk/var/lib/splunk/kvstorebackup/ Backup config files\nsudo -i cd /tmp mkdir /tmp/etc_backup$(date +\u0026#34;%d-%m-%Y\u0026#34;) cp -a /opt/splunk/etc/ /tmp/etc_backup$(date +\u0026#34;%d-%m-%Y\u0026#34;)/ Check backup\nls /tmp/etc_backup$(date +\u0026#34;%d-%m-%Y\u0026#34;)/etc 6. Install the New Version stop splunk using Splunk command\n/opt/splunk/bin/splunk stop stop splunk using systemctl command\nsystemctl stop splunk Unpack the Installer\ntar -xvzf /tmp/splunk-9.4.3-237ebbd22314-linux-amd64.tgz -C /opt/ Change the owner of the Splunk folder recursively with the account running Splunk\nchown -R splunk.splunk /opt/splunk Since I\u0026rsquo;m using a splunk user account (created without elevated privileges) to run splunk, I am switching to the account\nsu - splunk Start Splunk with License Acceptance\n/opt/splunk/bin/splunk start --accept-license --answer-yes 7. Post-Upgrade Verification Check if Splunk is running\n/opt/splunk/bin/splunk status Check recent logs for errors\ntail -20f /opt/splunk/var/log/splunk/splunkd.log Check Splunk version\n/opt/splunk/bin/splunk --version Check if Splunk service is run by splunk user\nps -ef | grep splunkd | grep -v grep 8. Documentation and Communication Update internal documentation with the new version details. Notify customer and colleagues of the successful upgrade. Share release notes and any post-upgrade instructions. ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://siemforge.xyz/notes/splunk/splunk-upgrade/","summary":"\u003cdiv style=\"display: block; width: 100%; max-width: none;\"\u003e\n\u003c!-- Upgrade procedure: --\u003e\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eUpgrade procedure:\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch1 id=\"splunk-upgrade-guide\"\u003eSplunk Upgrade Guide\u003c/h1\u003e\n\u003cp\u003eThis document provides a step-by-step procedure to upgrade Splunk from an existing version to a newer release. Follow each section carefully to ensure a smooth upgrade process.\u003c/p\u003e\n\u003ch2 id=\"table-of-contents\"\u003eTable of Contents\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003ePreparation\u003c/li\u003e\n\u003cli\u003eDownload and Transfer Files\u003c/li\u003e\n\u003cli\u003ePre-Upgrade Checks\u003c/li\u003e\n\u003cli\u003eDevice State Management\u003c/li\u003e\n\u003cli\u003eBackup Current Configuration\u003c/li\u003e\n\u003cli\u003eInstall the New Version\u003c/li\u003e\n\u003cli\u003ePost-Upgrade Verification\u003c/li\u003e\n\u003cli\u003eDocumentation and Communication\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"1-preparation\"\u003e1. Preparation\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eEnsure you have access to the target devices and necessary permissions.\u003c/li\u003e\n\u003cli\u003eConfirm the current Splunk version.\u003c/li\u003e\n\u003cli\u003eNotify customer and colleagues about the upcoming upgrade.\u003c/li\u003e\n\u003cli\u003eReview release notes for the target version.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"2-download-and-transfer-files\"\u003e2. Download and Transfer Files\u003c/h2\u003e\n\u003ch3 id=\"download-the-splunk-installer\"\u003eDownload the Splunk Installer\u003c/h3\u003e\n\u003cp\u003eYou can use the wget command to download the package on the host\nwget -O splunk-\u003cversion\u003e-\u003chash\u003e-Linux-x86_64.tgz \u0026ldquo;\u003ca href=\"https://download.splunk.com/products/splunk/releases/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://download.splunk.com/products/splunk/releases/\u003c/a\u003e\u003cversion\u003e/linux/splunk-\u003cversion\u003e-\u003chash\u003e-Linux-x86_64.tgz\u0026rdquo;\u003c/p\u003e","tags":null,"title":"Splunk Upgrade procedure"},{"categories":null,"contents":" Troubleshooting (files): Find a file or directory\nfind / -type f -name \u0026#34;filename\u0026#34; 2\u0026gt;/dev/null find / -type d -name \u0026#34;dirname\u0026#34; 2\u0026gt;/dev/null find files that contain a pattern\nfind . -type f -exec grep -l \u0026#39;version\u0026#39; {} \\; Troubleshooting (system): Find a file or directory\nfind / -type f -name \u0026#34;filename\u0026#34; 2\u0026gt;/dev/null find / -type d -name \u0026#34;dirname\u0026#34; 2\u0026gt;/dev/null check if machine is a vm or barebone\ndmidecode -s system-manufacturer check folder disk usage\ndu -hs * | sort -h check open port\n(echo \u0026gt; /dev/tcp/10.254.4.54/22) \u0026gt;/dev/null 2\u0026gt;\u0026amp;1 \u0026amp;\u0026amp; echo \u0026#34;It\u0026#39;s up\u0026#34; || echo \u0026#34;It\u0026#39;s down\u0026#34; check for listening ports\nsudo lsof -i -P -n | grep LISTEN sudo netstat -tulpn | grep LISTEN sudo ss -tulpn | grep LISTEN sudo lsof -i:22 ## see a specific port such as 22 ## sudo nmap -sTU -O IP-address-Here Troubleshooting (SSL): Check expiry date on .pem file\nopenssl x509 -enddate -noout -in /path/to/certificate.pem Maintenance: dry-run an update on OS\nsudo yum check-update Check if a reboot is required\nneeds-restarting -r remove cache of updates for old data\nrm -rf /var/cache/yum block icmp\nsysctl -w net.ipv4.icmp_echo_ignore_all=1 File manipulation: remove empty lines from file\nsed -i \u0026#39;/^$/d\u0026#39; \u0026lt;filename\u0026gt; Account control: change to root\nsudo -i Grep sudo users\nrm -f /tmp/names; for user in $(getent passwd | cut -d: -f1); do count=$((count+1)); if sudo -l -U \u0026#34;$user\u0026#34; | grep -q \u0026#34;ALL\u0026#34;; then echo \u0026#34;$user\u0026#34; \u0026gt;\u0026gt; /tmp/names; echo \u0026#34;Checked $count of $(getent passwd | cut -d: -f1 | wc -l) users.\u0026#34;; fi; done; clear; cat /tmp/names; rm -f /tmp/names ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://siemforge.xyz/notes/linux/cli/","summary":"\u003cdiv style=\"display: block; width: 100%; max-width: none;\"\u003e\n\u003c!-- Troubleshooting: --\u003e\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eTroubleshooting (files):\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cp\u003eFind a file or directory\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efind / -type f -name \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;filename\u0026#34;\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efind / -type d -name \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;dirname\u0026#34;\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003efind files that contain a pattern\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efind . -type f -exec grep -l \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;version\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e{}\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003c!-- Troubleshooting: --\u003e\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eTroubleshooting (system):\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cp\u003eFind a file or directory\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efind / -type f -name \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;filename\u0026#34;\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efind / -type d -name \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;dirname\u0026#34;\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003echeck if machine is a vm or barebone\u003c/p\u003e","tags":null,"title":"Linux Bash commands"},{"categories":null,"contents":" Logrotate Configuration Cheat Sheet: This cheat sheet provides an extensive list of Logrotate configuration directives, their descriptions, and examples.\nUse this as a quick reference to master log rotation on Unix-like systems.\nBasic structure: Each configuration block is tied to a log file or set of log files. Example:\n/var/log/example.log { daily rotate 7 compress missingok notifempty create 0640 root adm } Configuration Directives \u0026amp; Examples: Basic Settings: rotate \u0026lt;count\u0026gt;\nKeep number of old log files before deleting them.\ndaily | weekly | monthly | yearly\nFrequency of rotation.\nCompression Options: compress\nCompress old versions of log files with gzip.\nnocompress\nDo not compress old logs.\ndelaycompress\nPostpone compression to the next rotation cycle (used with compress).\nFile Handling: missingok\nIgnore missing log files and don’t issue an error.\nnotifempty\nDo not rotate the log if it is empty.\nifempty\nRotate the log even if it is empty (default behavior).\ncreate \u0026lt;mode\u0026gt; \u0026lt;owner\u0026gt; \u0026lt;group\u0026gt;\nCreate a new log file with specified permissions.\ncopy\nMake a copy of the log file and truncate the original.\ncopytruncate\nTruncate the original log file after copying it (useful for active logs).\nDate \u0026amp; Naming: dateext\nAppend an extension with the current date to rotated log files.\ndateformat .%Y-%m-%d\nCustom format for dateext (e.g., .2025-06-06).\nextension \u0026lt;ext\u0026gt;\nForce specific extension for rotated files (e.g., .log).\nSize-Based Rotation: maxage \u0026lt;days\u0026gt;\nRemove rotated logs older than .\nminsize \u0026lt;size\u0026gt;\nRotate only if log size is above .\nsize \u0026lt;size\u0026gt;\nRotate if log file size meets threshold, regardless of time.\nmaxsize \u0026lt;size\u0026gt;\nDo not rotate if log is larger than specified size.\nDirectory \u0026amp; Scripts: olddir \u0026lt;dir\u0026gt;\nMove rotated logs to a specified directory.\nsharedscripts\nRun postrotate script once for all matching logs.\npostrotate/endscript\nScript to run after log rotation.\nprerotate/endscript\nScript to run before log rotation.\nfirstaction/endscript\nRun only once before rotation begins (before prerotate).\nlastaction/endscript\nRun once after rotation finishes (after postrotate).\ntabooext + \u0026lt;ext\u0026gt;\nTreat additional extensions as taboo (not rotated).\nFull Example Configuration: /var/log/myapp/*.log { daily rotate 10 size 100M compress delaycompress missingok notifempty create 0640 appuser adm sharedscripts postrotate systemctl reload myapp \u0026gt; /dev/null 2\u0026gt;\u0026amp;1 || true endscript } Tips: Run logrotate -d \u0026lt;config\u0026gt; to debug your config without applying changes. Use logrotate -f \u0026lt;config\u0026gt; to force rotation for testing. Logrotate is typically triggered via cron or systemd timers. Keep your config DRY by centralizing shared logic in /etc/logrotate.conf and using includes. ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://siemforge.xyz/notes/linux/logrotate/","summary":"\u003cdiv style=\"display: block; width: 100%; max-width: none;\"\u003e\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eLogrotate Configuration Cheat Sheet:\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cblockquote\u003e\n\u003cp\u003eThis cheat sheet provides an extensive list of Logrotate configuration directives, their descriptions, and examples.\u003cbr\u003e\nUse this as a quick reference to master log rotation on Unix-like systems.\u003c/p\u003e\u003c/blockquote\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eBasic structure:\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cp\u003eEach configuration block is tied to a log file or set of log files. Example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/var/log/example.log \u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    daily\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    rotate \u003cspan style=\"color:#ae81ff\"\u003e7\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    compress\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    missingok\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    notifempty\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    create \u003cspan style=\"color:#ae81ff\"\u003e0640\u003c/span\u003e root adm\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eConfiguration Directives \u0026amp; Examples:\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch4 id=\"basic-settings\"\u003eBasic Settings:\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003erotate \u0026lt;count\u0026gt;\u003c/code\u003e\u003cbr\u003e\nKeep \u003ccount\u003e number of old log files before deleting them.\u003c/p\u003e","tags":null,"title":"Logrotate config"},{"categories":null,"contents":" Script: add sudo user Create a sudo user that won\u0026rsquo;t prompt for password on executing sudo commands.\n#!/bin/bash # Ensure script is run as root if [[ $EUID -ne 0 ]]; then echo \u0026#34;❌ This script must be run as root\u0026#34; exit 1 fi # Prompt for new username read -p \u0026#34;Enter new username: \u0026#34; username # Check if user already exists if id \u0026#34;$username\u0026#34; \u0026amp;\u0026gt;/dev/null; then echo \u0026#34;⚠️ User \u0026#39;$username\u0026#39; already exists.\u0026#34; exit 1 fi # Prompt for password (silent input) read -s -p \u0026#34;Enter password for $username: \u0026#34; password echo read -s -p \u0026#34;Confirm password: \u0026#34; password_confirm echo # Check passwords match if [[ \u0026#34;$password\u0026#34; != \u0026#34;$password_confirm\u0026#34; ]]; then echo \u0026#34;❌ Passwords do not match.\u0026#34; exit 1 fi # Create user with home directory and bash shell useradd -m -s /bin/bash \u0026#34;$username\u0026#34; # Set user password echo \u0026#34;${username}:${password}\u0026#34; | chpasswd # Add user to sudo group usermod -aG sudo \u0026#34;$username\u0026#34; # Create a sudoers file to allow passwordless sudo echo \u0026#34;$username ALL=(ALL) NOPASSWD:ALL\u0026#34; \u0026gt; \u0026#34;/etc/sudoers.d/$username\u0026#34; chmod 440 \u0026#34;/etc/sudoers.d/$username\u0026#34; echo \u0026#34;✅ User \u0026#39;$username\u0026#39; created with bash shell and passwordless sudo access.\u0026#34; ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://siemforge.xyz/notes/linux/scripts/addsudouser/","summary":"\u003cdiv style=\"display: block; width: 100%; max-width: none;\"\u003e\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eScript: add sudo user\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cp\u003eCreate a sudo user that won\u0026rsquo;t prompt for password on executing sudo commands.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Ensure script is run as root\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e $EUID -ne \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e; \u003cspan style=\"color:#66d9ef\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;❌ This script must be run as root\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   exit \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Prompt for new username\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eread -p \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Enter new username: \u0026#34;\u003c/span\u003e username\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Check if user already exists\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e id \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$username\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u0026amp;\u0026gt;/dev/null; \u003cspan style=\"color:#66d9ef\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;⚠️ User \u0026#39;\u003c/span\u003e$username\u003cspan style=\"color:#e6db74\"\u003e\u0026#39; already exists.\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    exit \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Prompt for password (silent input)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eread -s -p \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Enter password for \u003c/span\u003e$username\u003cspan style=\"color:#e6db74\"\u003e: \u0026#34;\u003c/span\u003e password\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eread -s -p \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Confirm password: \u0026#34;\u003c/span\u003e password_confirm\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Check passwords match\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$password\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e !\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$password_confirm\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e; \u003cspan style=\"color:#66d9ef\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;❌ Passwords do not match.\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    exit \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Create user with home directory and bash shell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euseradd -m -s /bin/bash \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$username\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Set user password\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eusername\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003epassword\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e | chpasswd\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Add user to sudo group\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eusermod -aG sudo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$username\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Create a sudoers file to allow passwordless sudo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$username\u003cspan style=\"color:#e6db74\"\u003e ALL=(ALL) NOPASSWD:ALL\u0026#34;\u003c/span\u003e \u0026gt; \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/etc/sudoers.d/\u003c/span\u003e$username\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003echmod \u003cspan style=\"color:#ae81ff\"\u003e440\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/etc/sudoers.d/\u003c/span\u003e$username\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;✅ User \u0026#39;\u003c/span\u003e$username\u003cspan style=\"color:#e6db74\"\u003e\u0026#39; created with bash shell and passwordless sudo access.\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003c/div\u003e","tags":null,"title":"Logrotate config"},{"categories":null,"contents":" ncdu: Ncdu is a disk usage analyzer with a text-mode user interface. It is designed to find space hogs on a remote server where you don’t have an entire graphical setup available, but it is a useful tool even on regular desktop systems. Ncdu aims to be fast, simple, easy to use, and should be able to run on any POSIX-like system.\ninstall:\nwget https://dev.yorhel.nl/download/ncdu-2.8.1-linux-x86_64.tar.gz tar -xzf ncdu-2.8.1-linux-x86_64.tar.gz sudo mv ncdu /usr/local/bin/ usage:\nncdu \u0026lt;directory_name\u0026gt; ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://siemforge.xyz/notes/tools/ncdu/","summary":"\u003cdiv style=\"display: block; width: 100%; max-width: none;\"\u003e\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003encdu:\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cp\u003eNcdu is a disk usage analyzer with a text-mode user interface. It is designed to find space hogs on a remote server where you don’t have an entire graphical setup available, but it is a useful tool even on regular desktop systems. Ncdu aims to be fast, simple, easy to use, and should be able to run on any POSIX-like system.\u003cbr\u003e\ninstall:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewget https://dev.yorhel.nl/download/ncdu-2.8.1-linux-x86_64.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etar -xzf ncdu-2.8.1-linux-x86_64.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo mv ncdu /usr/local/bin/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eusage:\u003c/p\u003e","tags":null,"title":"ncdu"},{"categories":null,"contents":"Mastering Logrotate: The Unsung Hero of Log Management In the trenches of system administration, there\u0026rsquo;s one silent guardian that keeps your disk space from imploding under a mountain of logs: Logrotate. Whether you\u0026rsquo;re wrangling logs on a sprawling Kubernetes cluster or just babysitting a single Linux box, Logrotate ensures your logs don’t spiral out of control.\nIn this deep dive, we’ll explore how Logrotate works, why it’s essential, how to configure it like a pro, and how to troubleshoot when it throws a tantrum.\nWhat is Logrotate? At its core, Logrotate is a Unix utility designed to automatically rotate, compress, and remove log files. Think of it as your log janitor — sweeping away old logs, zipping them up neatly, and ensuring your system never runs out of space due to runaway logging.\nWhy It Matters: Imagine you’re running NGINX on a production server handling thousands of requests per second. Without log rotation, your access and error logs could balloon into gigabytes overnight. That’s a disk I/O nightmare waiting to happen.\nLogrotate Configuration: From Basics to Battle-Hardened Logrotate’s power lies in its flexibility. You can define global rules in /etc/logrotate.conf, or per-service rules in /etc/logrotate.d/.\nExample: /etc/logrotate.d/nginx /var/log/nginx/*.log { daily rotate 14 compress delaycompress missingok notifempty create 0640 www-data adm sharedscripts postrotate systemctl reload nginx \u0026gt; /dev/null 2\u0026gt;\u0026amp;1 || true endscript } What Each Directive Does: daily: Rotate logs every day (alternatives: weekly, monthly, or custom intervals).\nrotate 14: Keep 14 archived logs before purging.\ncompress: Gzip old logs to save space.\ndelaycompress: Wait a cycle before compressing (avoids compressing still-used logs).\nmissingok: Don’t freak out if a log file is missing.\nnotifempty: Skip rotation for empty logs.\ncreate 0640 www-data adm: Create new logs with specific permissions.\nsharedscripts: Ensures postrotate only runs once per log group.\npostrotate...endscript: What to do after rotating logs — in this case, gracefully reload NGINX.\nPro Tip: Use copytruncate if your app won’t release the log file handle — useful for apps that don\u0026rsquo;t support log reopening on SIGHUP.\nAutomating with Cron Logrotate is typically triggered by cron, so unless you\u0026rsquo;re into manual rotations (why?), make sure this line exists in your cron jobs:\n0 0 * * * /usr/sbin/logrotate /etc/logrotate.conf \u0026gt;/dev/null 2\u0026gt;\u0026amp;1 This runs it daily at midnight. You can customize it further with anacron or systemd timers if you\u0026rsquo;re using newer systems like RHEL 8+ or Ubuntu 22.04+.\nCommon Pitfalls and How to Debug Like a Boss Even a veteran sysadmin can get tripped up by Logrotate quirks. Here are some frequent headaches and their antidotes:\nProblem\tFix 🔁 Log not rotating?\tCheck if the cron job runs. Use logrotate -d for dry-run debugging.\n🔒 Permission denied?\tEnsure Logrotate has access (run as root or use sudo).\n❌ Syntax error in config?\tRun logrotate -v /etc/logrotate.conf to see what it’s doing.\n💾 Disk still filling up?\tReduce rotate count or increase compression aggressiveness.\n🔄 App not releasing log files?\tUse copytruncate or restart the service post-rotate.\nDocker Running containers? Docker log files can balloon fast under /var/lib/docker/containers/. You can use logrotate or — better — configure Docker\u0026rsquo;s own json-file driver like this:\n{ \u0026#34;log-driver\u0026#34;: \u0026#34;json-file\u0026#34;, \u0026#34;log-opts\u0026#34;: { \u0026#34;max-size\u0026#34;: \u0026#34;50m\u0026#34;, \u0026#34;max-file\u0026#34;: \u0026#34;3\u0026#34; } } Boom — Docker will auto-rotate logs per container.\nFinal Thoughts Logrotate might not be flashy, but it’s a critical piece of your system\u0026rsquo;s hygiene. Treat it like a core dependency — because it is. With smart configurations, regular checks, and a few advanced tweaks, you can keep your logs lean, searchable, and under control.\nWhether you\u0026rsquo;re taming Apache logs, managing containerized chaos, or just keeping your home lab in shape, Logrotate will be your quiet, powerful ally.\nTL;DR Cheat Sheet Config files: /etc/logrotate.conf, /etc/logrotate.d/*\nCommon flags: daily, rotate, compress, create, copytruncate\nDebug command: logrotate -d /etc/logrotate.conf\nTest manually: logrotate -f /etc/logrotate.conf\nKeep it cron’d: crontab -e\nA more extensive cheatsheet can be found here: Logrotate cheatsheet\nNow go forth and rotate like a boss. 🌀\n","date":"June 6, 2025","hero":"/images/posts/logrotate.jpg","permalink":"https://siemforge.xyz/posts/linux/logrotate/logrotate/","summary":"\u003ch1 id=\"mastering-logrotate-the-unsung-hero-of-log-management\"\u003eMastering Logrotate: The Unsung Hero of Log Management\u003c/h1\u003e\n\u003cp\u003eIn the trenches of system administration, there\u0026rsquo;s one silent guardian that keeps your disk space from imploding under a mountain of logs: \u003cstrong\u003eLogrotate\u003c/strong\u003e. Whether you\u0026rsquo;re wrangling logs on a sprawling Kubernetes cluster or just babysitting a single Linux box, Logrotate ensures your logs don’t spiral out of control.\u003c/p\u003e\n\u003cp\u003eIn this deep dive, we’ll explore how Logrotate works, why it’s essential, how to configure it like a pro, and how to troubleshoot when it throws a tantrum.\u003c/p\u003e","tags":null,"title":"Logrotate"}]