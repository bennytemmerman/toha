<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Splunk Notes on SIEMForge</title><link>https://siemforge.xyz/notes/splunk/</link><description>Recent content in Splunk Notes on SIEMForge</description><generator>Hugo -- gohugo.io</generator><language>en</language><atom:link href="https://siemforge.xyz/notes/splunk/index.xml" rel="self" type="application/rss+xml"/><item><title>Splunk searches</title><link>https://siemforge.xyz/notes/splunk/basic/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://siemforge.xyz/notes/splunk/basic/</guid><description>&lt;!-- Errorcheck within Splunk GUI -->
&lt;div class="note-card ">
&lt;div class="item">
&lt;h5 class="note-title">&lt;span>Troubleshooting: Errorcheck within Splunk GUI&lt;/span>&lt;/h5>
&lt;div class="card">
&lt;div class="card-body">&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>index&lt;span style="color:#f92672">=&lt;/span>_internal log_level&lt;span style="color:#f92672">=&lt;/span>ERROR source&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;/opt/splunk/var/log/splunk/splunkd.log&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;!-- Index list -->
&lt;div class="note-card ">
&lt;div class="item">
&lt;h5 class="note-title">&lt;span>Index: List indexes with the retention period&lt;/span>&lt;/h5>
&lt;div class="card">
&lt;div class="card-body">&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>| rest splunk_server&lt;span style="color:#f92672">=&lt;/span>* /services/data/indexes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| eval &lt;span style="color:#e6db74">&amp;#34;Retention Period (months)&amp;#34;&lt;/span>&lt;span style="color:#f92672">=&lt;/span>round&lt;span style="color:#f92672">((&lt;/span>frozenTimePeriodInSecs/2628000&lt;span style="color:#f92672">)&lt;/span>,0&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| search NOT title IN &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#e6db74">&amp;#34;_*&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;main&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;history&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;summary&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;splunklogger&amp;#34;&lt;/span>&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| table title &lt;span style="color:#e6db74">&amp;#34;Retention Period (months)&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| rename title as Index
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">```&lt;/span>&lt;span style="color:#66d9ef">for&lt;/span> years, divide frozenTimePeriodInSecs/31556952; &lt;span style="color:#66d9ef">for&lt;/span> days, divide frozenTimePeriodInSecs/86400&lt;span style="color:#e6db74">```&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;!-- Host list -->
&lt;div class="note-card ">
&lt;div class="item">
&lt;h5 class="note-title">&lt;span>Hosts: Overview of hosts sending logs by index&lt;/span>&lt;/h5>
&lt;div class="card">
&lt;div class="card-body">&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>| tstats values&lt;span style="color:#f92672">(&lt;/span>host&lt;span style="color:#f92672">)&lt;/span> where index&lt;span style="color:#f92672">=&lt;/span>* by index
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;!-- License usage -->
&lt;div class="note-card ">
&lt;div class="item">
&lt;h5 class="note-title">&lt;span>License: Usage per day by index &amp;#43; percentages&lt;/span>&lt;/h5>
&lt;div class="card">
&lt;div class="card-body">&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>index&lt;span style="color:#f92672">=&lt;/span>_internal source&lt;span style="color:#f92672">=&lt;/span>*license_usage.log type&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;Usage&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| bin _time span&lt;span style="color:#f92672">=&lt;/span>1d
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| stats sum&lt;span style="color:#f92672">(&lt;/span>b&lt;span style="color:#f92672">)&lt;/span> as b by idx, _time
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| eval GB&lt;span style="color:#f92672">=&lt;/span>round&lt;span style="color:#f92672">((&lt;/span>b/1024/1024/1024&lt;span style="color:#f92672">)&lt;/span>,2&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| eventstats sum&lt;span style="color:#f92672">(&lt;/span>GB&lt;span style="color:#f92672">)&lt;/span> as total_GB by _time
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| eval percentage&lt;span style="color:#f92672">=&lt;/span>round&lt;span style="color:#f92672">((&lt;/span>GB/total_GB&lt;span style="color:#f92672">)&lt;/span>*100,2&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| sort -_time -GB
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| fields - b, total_GB
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| rename idx as Index, GB as &lt;span style="color:#e6db74">&amp;#34;Size (GB)&amp;#34;&lt;/span>, percentage as &lt;span style="color:#e6db74">&amp;#34;Percentage (%)&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| convert timeformat&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;%Y-%m-%d&amp;#34;&lt;/span> ctime&lt;span style="color:#f92672">(&lt;/span>_time&lt;span style="color:#f92672">)&lt;/span> as Date
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| fields Date, Index, &lt;span style="color:#e6db74">&amp;#34;Size (GB)&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Percentage (%)&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">```&lt;/span>&lt;span style="color:#66d9ef">for&lt;/span> years, divide frozenTimePeriodInSecs/31556952; &lt;span style="color:#66d9ef">for&lt;/span> days, divide frozenTimePeriodInSecs/86400&lt;span style="color:#e6db74">```&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;!-- Index list -->
&lt;div class="note-card ">
&lt;div class="item">
&lt;h5 class="note-title">&lt;span>Index: List indexes&lt;/span>&lt;/h5>
&lt;div class="card">
&lt;div class="card-body">&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>| eventcount summarize&lt;span style="color:#f92672">=&lt;/span>false index&lt;span style="color:#f92672">=&lt;/span>*
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| dedup index
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| fields index
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/div>
&lt;/div>
&lt;/div></description></item></channel></rss>