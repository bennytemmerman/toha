<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Splunk notes on SIEMForge</title><link>https://siemforge.xyz/notes/2.splunk/</link><description>Recent content in Splunk notes on SIEMForge</description><generator>Hugo -- gohugo.io</generator><language>en</language><atom:link href="https://siemforge.xyz/notes/2.splunk/index.xml" rel="self" type="application/rss+xml"/><item><title>Splunk searches</title><link>https://siemforge.xyz/notes/2.splunk/spl/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://siemforge.xyz/notes/2.splunk/spl/</guid><description>&lt;div style="display: block; width: 100%; max-width: none;"&gt;
&lt;div class="note-card "&gt;
&lt;div class="item"&gt;
&lt;h5 class="note-title"&gt;&lt;span&gt;&lt;/span&gt;&lt;/h5&gt;
&lt;div class="card"&gt;
&lt;div class="card-body"&gt;&lt;blockquote&gt;
&lt;p&gt;Most queries are tested on my onprem homelab servers. Sometimes rights might be limited for example in SplunkCloud for &amp;ldquo;| rest&amp;rdquo; queries.&lt;br&gt;
Using tstats is faster to search in large datapools.&lt;/p&gt;
&lt;/blockquote&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Troubleshooting: --&gt;
&lt;div class="note-card "&gt;
&lt;div class="item"&gt;
&lt;h5 class="note-title"&gt;&lt;span&gt;Troubleshooting:&lt;/span&gt;&lt;/h5&gt;
&lt;div class="card"&gt;
&lt;div class="card-body"&gt;&lt;p&gt;When troubleshooting I mostly start with this query:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;index&lt;span style="color:#f92672"&gt;=&lt;/span&gt;_internal log_level&lt;span style="color:#f92672"&gt;=&lt;/span&gt;ERROR source&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;/opt/splunk/var/log/splunk/splunkd.log&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Errorcheck Splunkd.log within Splunk GUI&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;index&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;index_name&amp;#34;&lt;/span&gt; host&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;host_name&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;| sort sourcetype, _time
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;| streamstats current&lt;span style="color:#f92672"&gt;=&lt;/span&gt;f last&lt;span style="color:#f92672"&gt;(&lt;/span&gt;_time&lt;span style="color:#f92672"&gt;)&lt;/span&gt; as prev_time by sourcetype
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;| eval gap&lt;span style="color:#f92672"&gt;=&lt;/span&gt;_time - prev_time
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;| where gap &amp;gt; &lt;span style="color:#ae81ff"&gt;3600&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;| eval gap_in_hours&lt;span style="color:#f92672"&gt;=&lt;/span&gt;round&lt;span style="color:#f92672"&gt;(&lt;/span&gt;gap/3600,2&lt;span style="color:#f92672"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;| eval prev_time_str&lt;span style="color:#f92672"&gt;=&lt;/span&gt;strftime&lt;span style="color:#f92672"&gt;(&lt;/span&gt;prev_time, &lt;span style="color:#e6db74"&gt;&amp;#34;%Y-%m-%d %H:%M:%S&amp;#34;&lt;/span&gt;&lt;span style="color:#f92672"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;| table sourcetype _time prev_time prev_time_str gap gap_in_hours
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Check for gaps in log ingestion and return results over 1 hour gaps.
Troubleshooting for false positive due to unreliable log ingestion of a logtype while other logtypes indicated ongoing log ingestion.&lt;/p&gt;</description></item><item><title>Splunk searches</title><link>https://siemforge.xyz/notes/2.splunk/gui/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://siemforge.xyz/notes/2.splunk/gui/</guid><description>&lt;div style="display: block; width: 100%; max-width: none;"&gt;
&lt;div class="note-card "&gt;
&lt;div class="item"&gt;
&lt;h5 class="note-title"&gt;&lt;span&gt;Debug refresh:&lt;/span&gt;&lt;/h5&gt;
&lt;div class="card"&gt;
&lt;div class="card-body"&gt;&lt;p&gt;If you change layout, configuration, or app files in Splunk, you can reload the resources through the web GUI, which is faster than restarting Splunk.
If you still donâ€™t see your changes, you might need to restart Splunk completely to clear cached data and make sure all updates are applied.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;https://&amp;lt;host&amp;gt;:&amp;lt;port&amp;gt;/debug/refresh
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;JavaScript (JS) files:&lt;/strong&gt; Updates to scripts that run in the browser UI.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;XML and HTML files:&lt;/strong&gt; Changes to the layout, structure, or look of the interface.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Configuration files:&lt;/strong&gt; Settings that control how Splunk works.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;App files:&lt;/strong&gt; Other resources and assets within your Splunk apps that have been changed.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href="https://dev.splunk.com/enterprise/docs/developapps/manageknowledge/assetcaching/?_gl=1*16bjotw*_gcl_aw*R0NMLjE3NTk5ODg2ODQuQ2owS0NRandsNWpIQmhESEFSSXNBQjBZcWp3NHJhQk1uUUVyeEc5OXcweGt0TU0tTWl6cjB2N05lV1RiYi1kSGt4endkOHZWQ0NFVy1YUWFBa2l3RUFMd193Y0I.*_gcl_au*NDc3MjU1Nzc0LjE3NTg2MDcyNjY.*FPAU*NDc3MjU1Nzc0LjE3NTg2MDcyNjY.*_ga*Mzg3OTA2MjM0LjE3NDI0NjQ3MzU.*_ga_5EPM2P39FV*czE3NjExMTYwNjgkbzkzJGcwJHQxNzYxMTE2MDY4JGo2MCRsMCRoMTIyNDM2OTU4MQ..*_fplc*RXhXckVEOVBuVjZxRzQ0M3RhJTJGWGVmVXJVdEFkRHFOUlZFdHAlMkZXbzRreHZBSEpDMVclMkIzN2JtMkJwMUZMTGpoamtEOGo5NjFGQnhhalZBSGpzNDdZSHZqY2syRjc0WFJXWTFISUNyeTcxOEtTWnZEZEQxeER0QyUyRjhzUndLUGclM0QlM0Q." target="_blank" rel="noopener"&gt;resource&lt;/a&gt;&lt;/p&gt;</description></item><item><title>Splunk CLI commands</title><link>https://siemforge.xyz/notes/2.splunk/cli/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://siemforge.xyz/notes/2.splunk/cli/</guid><description>&lt;div style="display: block; width: 100%; max-width: none;"&gt;
&lt;!-- CLI commands: --&gt;
&lt;div class="note-card "&gt;
&lt;div class="item"&gt;
&lt;h5 class="note-title"&gt;&lt;span&gt;CLI commands:&lt;/span&gt;&lt;/h5&gt;
&lt;div class="card"&gt;
&lt;div class="card-body"&gt;&lt;p&gt;These are some commands to use in CLI, while a gui is available, I like to do most things using the command line interface.&lt;/p&gt;
&lt;h3 id="basic-operations"&gt;Basic operations&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/opt/splunk/bin/splunk start
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Start Splunk&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/opt/splunk/bin/splunk stop
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Stop Splunk&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/opt/splunk/bin/splunk restart
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Restart Splunk&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/opt/splunk/bin/splunk status
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Check if Splunk is running&lt;/p&gt;
&lt;h3 id="general-checks"&gt;General checks&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/opt/splunk/bin/splunk list user | grep admin -B2
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Check Splunk admins&lt;/p&gt;
&lt;h3 id="splunk-service-setup"&gt;Splunk service setup&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/opt/splunk/bin/splunk enable
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Enable Splunk service to start when the host boots up&lt;/p&gt;</description></item><item><title>Splunk Upgrade procedure</title><link>https://siemforge.xyz/notes/2.splunk/splunk-upgrade/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://siemforge.xyz/notes/2.splunk/splunk-upgrade/</guid><description>&lt;div style="display: block; width: 100%; max-width: none;"&gt;
&lt;!-- Upgrade procedure: --&gt;
&lt;div class="note-card "&gt;
&lt;div class="item"&gt;
&lt;h5 class="note-title"&gt;&lt;span&gt;Upgrade procedure:&lt;/span&gt;&lt;/h5&gt;
&lt;div class="card"&gt;
&lt;div class="card-body"&gt;&lt;h1 id="splunk-upgrade-guide"&gt;Splunk Upgrade Guide&lt;/h1&gt;
&lt;p&gt;This document provides a step-by-step procedure to upgrade Splunk from an existing version to a newer release. Follow each section carefully to ensure a smooth upgrade process.&lt;/p&gt;
&lt;h2 id="table-of-contents"&gt;Table of Contents&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Preparation&lt;/li&gt;
&lt;li&gt;Download and Transfer Files&lt;/li&gt;
&lt;li&gt;Pre-Upgrade Checks&lt;/li&gt;
&lt;li&gt;Device State Management&lt;/li&gt;
&lt;li&gt;Backup Current Configuration&lt;/li&gt;
&lt;li&gt;Install the New Version&lt;/li&gt;
&lt;li&gt;Post-Upgrade Verification&lt;/li&gt;
&lt;li&gt;Documentation and Communication&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="1-preparation"&gt;1. Preparation&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Ensure you have access to the target devices and necessary permissions.&lt;/li&gt;
&lt;li&gt;Confirm the current Splunk version.&lt;/li&gt;
&lt;li&gt;Notify customer and colleagues about the upcoming upgrade.&lt;/li&gt;
&lt;li&gt;Review release notes for the target version.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="2-download-and-transfer-files"&gt;2. Download and Transfer Files&lt;/h2&gt;
&lt;h3 id="download-the-splunk-installer"&gt;Download the Splunk Installer&lt;/h3&gt;
&lt;p&gt;You can use the wget command to download the package on the host
wget -O splunk-&lt;version&gt;-&lt;hash&gt;-Linux-x86_64.tgz &amp;ldquo;&lt;a href="https://download.splunk.com/products/splunk/releases/" target="_blank" rel="noopener"&gt;https://download.splunk.com/products/splunk/releases/&lt;/a&gt;&lt;version&gt;/linux/splunk-&lt;version&gt;-&lt;hash&gt;-Linux-x86_64.tgz&amp;rdquo;&lt;/p&gt;</description></item></channel></rss>